<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Calendar - OpenXava</title>
    <link rel="stylesheet" href="static/style.css" type="text/css">
    <link rel="stylesheet" href="highlight/highlight.css">
    <script src="highlight/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div class="wiki" style="display: block;">
      <h1 id="toc0"> <span id="breadcrumbs"> <span id="openxava"> <a href="https://www.openxava.org/">
              <span>o</span>pen<span>x</span>ava </a> </span> / <a href="index_en.html">documentation</a>
          / </span>Calendar</h1>
      <div class="wiki" style="display: block;">
        <h2>Video</h2>
        <p>In this video, we'll see how we can use a calendar in any
          module with a date and also how to create a "My Calendar"
          module with a personal calendar.</p>
        <p><a href="https://youtu.be/e2tzPQ_hpZE" target="_blank"><img src="files/dashboard_es010.png"
              title="dashboard_es010"></a> </p>
        <p><strong>Any problem with this lesson? <a class="wiki_link_ext" href="http://sourceforge.net/p/openxava/discussion/419690/">Ask
              in the forum</a></strong></p>
      </div>
      <div class="wiki" style="display: block;">
        <h2>Code</h2>
        <p>You can copy the code used in the video from here:</p>
        <code class="xml"></code> In the <em>application.xml</em> file add
        the following module:<br>
        <pre><code class="xml">&lt;module name="MyCalendar"&gt;
    &lt;model name="Issue"/&gt;
    &lt;tab name="MyCalendar"/&gt;
    &lt;controller name="MyCalendar"/&gt;
&lt;/module&gt;
</code></pre> <code class="xml"></code> In the <em>controllers.xml</em>
        file add the following controller:<br>
        <pre><code class="xml">&lt;controller name="MyCalendar"&gt;
    &lt;extends controller="CRUD"/&gt;
    &lt;action name="new" icon="library-plus" keystroke="Control N"
        class="com.yourcompany.projects.actions.NewIssueFromMyCalendarAction"&gt;
    &lt;/action&gt;
    &lt;action name="save" mode="detail"
        by-default="if-possible"
        class="com.yourcompany.projects.actions.SaveReturningToListAction"
        icon="content-save"
        keystroke="Control S"/&gt;
&lt;/controller&gt;
</code></pre>Create the action <i><em>NewIssueFromMyCalendarAction.java</em></i>:
        <pre><code class="java">package com.yourcompany.projects.actions;

import org.openxava.actions.*;

public class NewIssueFromMyCalendarAction extends NewAction {
	
    private boolean goList = false;
	
    @Override
    public void execute() throws Exception {
        if ("true".equals(getRequest().getParameter("firstRequest"))) {
            goList = true;
            return;
        }
        super.execute();
    }
	
    @Override
    public String getNextMode() {
        return goList?IChangeModeAction.LIST:IChangeModeAction.DETAIL;
    }

}
</code></pre> Create the action <i><em>SaveReturningToListAction.java</em></i>:
        <pre><code class="java">package com.yourcompany.projects.actions;

import org.openxava.actions.*;

public class SaveReturningToListAction extends SaveAction  {
	
    @Override
    public String getNextMode() {
        return getErrors().contains()?DETAIL:LIST;
    }

}
</code></pre>
        <p>In the <em>Issue.java</em> entity add the <i>@Tab MyCalendar</i>:</p>
        <pre><code class="java">@Tab(name="MyCalendar", editors="Calendar",
    properties="title",
    baseCondition = "${createdBy} = ?",
    filter=org.openxava.filters.UserFilter.class)
public class Issue extends Identifiable {
</code></pre>
        <p>Also in the <em>Issue.java</em> entity add the <i>plannedFor</i> property
          in the class body and in <i>@View</i>:</p>
        <pre><code class="java">@View(members=
    "title, type;" +
    "description;" +
    "details [#" +
        "project, createdBy;" +
        "createdOn, priority;" +
        "version, assignedTo;" +
        "status, customer;" +
        "plannedFor, minutes, hours;" + // Add plannedFor in @View
    "];" +
    "attachments;" +
    "discussion"
)
public class Issue extends Identifiable {

    ...

    LocalDate plannedFor; // Add plannedFor as attribute
</code></pre>
        <p>In the <em>custom.css</em> file:</p>
        <pre><code class="css">#ox_projects_MyCalendar__core .ox-list-title {
    display: none;
}

#ox_projects_MyCalendar__core .xava_calendar_date_preferences {
    display: none;
}

#ox_projects_MyCalendar__core #xava_calendar {
    margin-top: 20px;
}
</code></pre>
        <h2>Transcript</h2>
        Hello, I'm Monica.<br>
        In this video...</div>
    </div>
  </body>
</html>
