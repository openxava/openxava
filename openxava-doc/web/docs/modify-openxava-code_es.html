<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Modificar código de OpenXava</title>
    <link rel="stylesheet" href="static/style.css" type="text/css">
  </head>
  <body>
    <div class="wiki" id="content_view" style="display: block;">
      <h1 id="toc0"> <span id="breadcrumbs"> <span id="openxava"> <a href="https://www.openxava.org/">
              <span>o</span>pen<span>x</span>ava </a> </span> / <a href="index_es.html">documentación</a>
          / </span> Modificar código de OpenXava</h1>
      Puedes modificar el código de OpenXava para adaptarlo a tus necesidades,
      arreglar algún fallo, añadir nuevas características, etc.</div>
    <div class="wiki" style="display: block;">
      <h2 id="toc1">Desde v7.0</h2>
      <div class="wiki" style="display: block;">El código de OpenXava ya no se
        incluye en la distribución, ahora lo tienes que coger desde el <a href="https://github.com/openxava/openxava">repositorio
          de OpenXava en GitHub repository</a>. El código de OpenXava
        propiamente dicho está en el proyecto <i>openxava</i> dentro del
        repositorio:</div>
      <img src="files/openxava-in-github_es.png">
      <div class="wiki" style="display: block;">Puedes modificarlo, compilarlo e
        instalarlo usando Git, Maven y tu IDE favorito. Si no estás
        familiarizado con Git y Maven, aquí te presentamos una guía detallada
        para modificar el código de OpenXava para tu aplicación usando OpenXava
        Studio.</div>
      <div class="wiki" style="display: block;">
        <h3>Descargar el código desde GitHub</h3>
        <p>Primero ve a la <a href="https://github.com/openxava/openxava">pagina
            de OpenXava en GitHub</a> y copia la URL del repositorio:</p>
        <img src="files/copy-openxava-repository-url_es.png">
        <p>Después abre la perspectiva Git en OpenXava Studio, para ello pulsa
          en el botón en la esquina superior derecha:</p>
        <img src="files/add-perspective-eclipse.png" alt=""></div>
      <div class="wiki" style="display: block;">Esto muestra un diálogo, escoge
        la perspectiva Git:</div>
      <div class="wiki" style="display: block;"><img src="files/choose-git-perspective-eclipse.png"
          alt=""><br>
        <p>Una vez en la perspectiva Git, pulsa en <i>Clone a Git repository</i>:</p>
        <img src="files/clone-git-repository-option-eclipse.png" alt="">
        <p>Dado que la has copiado desde la página de GitHub, la URL del
          repositorio OpenXava se ha rellenado automáticamente, sólo tienes que
          pulsar en <i>Next</i>:</p>
        <img src="files/clone-git-repository-step1-eclipse.png" alt="">
        <p>Se muestran todas las ramas, simplemente pulsa en <i>Next</i>:</p>
        <img src="files/clone-git-repository-step2-eclipse.png" alt="">
        <p>Para acabar pulsa en <i>Finish</i>:</p>
        <img src="files/clone-git-repository-step3-eclipse.png" alt="">
        <p>Ahora sé paciente mientras que el código del repositorio se descarga
          desde GitHub:</p>
        <img src="files/progress-importing-repository-eclipse.png" alt="">
        <p>Cuando acabe tendrás el repositorio <i>openxava </i>listado en la
          parte izquierda de OpenXava Studio:</p>
        <img src="files/openxava-repository-git-perspective-eclipse.png" alt="">
        <p>¡Enhorabuena! El repositorio de OpenXava está descargado en tu
          ordenador y configurado en el OpenXava Studio. El siguiente paso es
          importar el proyecto <i>openxava</i> en tu workspace.</p>
        <h3>Importar openxava en el workspace</h3>
        <p>Primero, vuelve a la perspectiva Java, para ello pulsa el botón
          correspondiente en la esquina superior derecha del OpenXava Studio:</p>
        <img src="files/change-to-java-perspective-eclipse.png" alt="">
        <p>Para importar el proyecto <i>openxava</i> pulsa en <i>File &gt;
            Import...</i>: </p>
        <img src="files/file-import-eclipse.png" alt="">
        <p>Ahora selecciona <i>Git &gt; Projects from Git (with smart import)</i>
          y pulsa en <i>Next</i>:</p>
        <img src="files/import-step1-eclipse.png" alt="">
        <p>Escoge <i>Existing local repository</i> y pulsa en <i>Next</i>:</p>
        <img src="files/import-step2-eclipse.png" alt="">
        <p>Selecciona el repositorio <i>openxava</i> y pulsa en <i>Next</i>:</p>
        <img src="files/import-step3-eclipse.png" alt=""></div>
      <div class="wiki" style="display: block;">Desmarca todos los proyectos y
        deja solo marcado <i>openxava\openxava</i>. Pulsa en <i>Finish</i>: <br>
        <img src="files/import-step4-eclipse.png" alt="">
        <p>Y por fin el proyecto <i>openxava</i> con todo su código está en tu
          workspace:</p>
        <img src="files/openxava-project-in-workspace-eclipse.png" alt="">
        <p>Ahora ya puedes modificar el código de openxava a tu gusto.</p>
        <h3>Modificar código de OpenXava</h3>
        <p>Primero, asegurate de que la versión en <i>openxava/pom.xml</i> es
          una SNAPSHOT. Abre el <i>pom.xml</i> dentro del proyecto <i>openxava</i>
          y verifica la versión:</p>
        <img src="files/openxava-pom-snapshot-version-eclipse.png" alt="">
        <p>Si estás usando la rama master seguramente la versión será una
          SNAPSHOT, si no modificala añadiendo el sufijo -SNAPSHOT. Esto
          significa que es una versión de trabajo, sin código congelado sino
          lista para ser modificada.</p>
        <p>Ahora es el momento de modificar el código. Por ejemplo, edita el
          código de <i>NewAction.java</i> code añadiendo un print, como esto:</p>
        <img src="files/modifying-new-action.png" alt="">
        <p>Después haz un <i>mvn install</i> en <i>openxava</i>, de esta
          manera:</p>
        <img src="files/openxava-maven-install-eclipse.png" alt="">
        <p>En esta ocasión no es necesario hacer un <i>mvn clean</i> porque
          acabamos de descargar el código y <i>target</i> está vacío, pero si
          coges código nuevo desde GitHub (con un pull) deberías hacer un <i>mvn
            clean</i> también.</p>
        <p>Ahora, ve a tu proyecto, edita el <i>pom.xml</i> y pon en la
          propiedad <i>openxava.version</i> el valor de la versión SNAPSHOT de
          OpenXava que tienes en tu workspace:</p>
        <img src="files/invoicing-pom-update-to-snapshot.png" alt="">
        <p>Esto es importante, porque si no tu proyecto no usará tu versión
          modificada sino la versión oficial de Maven Central.</p>
        <p>Después haz un <i>mvn clean</i> en tu proyecto:</p>
        <img src="files/invoicing-maven-clean.png" alt="">
        <p>Y un <i>mvn install</i> también en tu proyecto:</p>
        <img src="files/invoicing-maven-install.png" alt="">
        <p>!Enhorabuena! Tu proyecto está listo para que lo ejecutes con tu
          OpenXava modificado. Pruébalo.</p>
        <h3>Acortar el ciclo de modificación</h3>
        <p>Los pasos de arriba son para la primera modificación. A partir de
          ahora va a ser más fácil. Para hacer una modificación sólo necesitas
          tres pasos:</p>
        <ol>
          <li>Modifica el código de openxava.</li>
          <li>Haz un mvn install en openxava.</li>
          <li>Haz un mvn war:exploded en tu proyecto. Para esto puedes usar Run
            As &gt; Build Maven ...</li>
        </ol>
        <p>Y la siguiente vuelta de tuerca es usar el modo debug. Arranca tu
          aplicación pulsando el escarabajo:</p>
        <img src="files/debug-button-eclipse.png" alt="">
        <p>De esta forma podrás modificar el código de openxava y ver el
          resultado en el acto, sin relanzar la aplicación e incluso sin
          recargar la página en el navegadro. Magia pura.</p>
        <h3>Recarga del código en caliente <i>(nuevo en v7.5)</i></h3>
        <p>A partir de la versión 7.5 puedes acorta todavía más el ciclo de
          modificación gracias a la <a href="hot-code-reloading_es.html">carga
            del código en caliente</a>, si usas el JDK incluido en OpenXava
          Studio 7 R4. Pero para que el código de OpenXava también se recargue
          en caliente has de hacer una pequeña modificación en tu clase
          lanzadora:</p>
        <pre><code class="java">public static void main(String[] args) throws Exception {
    AppServer.run("tuaplicacion", "../openxava/target/classes"); 
}
</code></pre>
        <p>Nota como añadimos como segundo argumento la ruta de las clases del
          proyecto <i>openxava</i>. En el ejemplo partimos de la base de que
          tienes <i>openxava</i> y tu proyecto en el mismo directorio. De esta
          forma el ciclo de modificación se reduce a nada. Solo has de tocar el
          código Java en <i>openxava</i> y usar tu aplicación en el navegador,
          ni siquiera has de recargar para tener los efectos. </p>
        <p>La recarga del código en caliente no incluye los recursos web (JSP,
          HTML, CSS, etc) para eso tendrás que copiar los archivos (usando el
          sistema operativo) desde <i>openxava/src/main/resources/META-INF/resources</i>
          a <i>tuaplicacion/target/tuaplicacion</i>. Así, tendrias los cambios
          con solo pulsar en recargar en el navegador, además sin ensuciar el
          proyecto porque todo lo que hay en <i>target</i> se va al hacer un <i>mvn
            clean</i>.</p>
        <h3></h3>
        <p></p>
        <h3>Ramas</h3>
        <p>En el ejemplo de arriba hemos modicado directamente la rama master,
          lo que no es un problema dado que no tienes permisos para hacer un
          push contra el repositorio de OpenXava. Sin embargo, puedes hacer un
          uso más avanzado de las ramas. Como mínimo, deberías crear tu propia
          rama antes de hacer cualquier cambio y hacer el cambio en tu propia
          rama. Cuando el cambio esté completo y funcione bien, puedes mezclar
          tu rama con el master.</p>
        Si quieres contribuir código a OpenXava, deberías crearte una cuenta en
        GitHub y después hacer un clon del repositorio de OpenXava en tu cuenta.
        Sigue las instrucciones de arriba pero coge el código de tu propio
        repositorio en vez desde openxava/openxava. De esta forma, puedes crear
        una rama, hacer un push y crear un pull request contra el repositorio
        original de OpenXava, donde podría ser aprobado e incluido en la
        siguiente versión oficial de OpenXava.</div>
      <h2 id="toc1">Desde v6.4</h2>
      <i> Has de definir OpenXava.buildOpenXava (o OpenXava.buildAddons) en
        External Tools de Eclipse (OpenXava Studio). Para aprender como ejecutar
        o definir tareas Ant en Eclipse <a href="ant-from-eclipse_en.html">sigue
          estas instrucciones</a>.</i>
      <div class="wiki" style="display: block;"><i><b></b></i></div>
    </div>
    <div class="wiki" style="display: block;"><i><b>Necesitas un JDK para
          ejecutar las tareas Ant</b>. En Eclipse ve a External Tools &gt;
        OpenXava.buildOpenXava (o buildAddons) &gt; JRE y escoge un JDK. A veces
        puede fallar si el tools.jar en el classpath no coincide con el JDK
        usado.</i>
      <div class="wiki" style="display: block;"><i>Si tienes <b>problemas</b>
          compilando <b>con acentos</b> ve a External Tools &gt;
          OpenXava.buildOPenxava (o buildAddons) &gt; Common &gt; Encoding : <b>ISO-8859-1</b>
          (no es necesario desde v6.5.2)<br>
        </i></div>
      <div class="wiki" style="display: block;"></div>
    </div>
    <div class="wiki" style="display: block;"><br>
    </div>
    <div class="wiki" style="display: block;"> Para modificar el código Java,
      XML o archivos i18n de OpenXava:</div>
    <div class="wiki" style="display: block;">
      <ul>
        <li>Modifica el código en <i>OpenXava/src</i>, <i>OpenXava/xava</i> o
          <i>OpenXava/i18n</i>. Estas no son carpetas de código fuente para
          Eclipse, por lo que el Eclipse no las compila.</li>
        <li>Ejecuta la tarea Ant <i>buildOpenXava</i> de <i>OpenXava/build.xml</i>.
          Esto compila el código Java de OpenXava y crea <i>openxava.jar</i>.</li>
        <li>Refresca el proyecto OpenXava en Eclipse (F5).</li>
        <li>Ejecuta la tarea Ant <i>actualizarOX</i> del <i>build.xml</i> de
          tu propio proyecto. Esto copia el nuevo <i>openxava.jar</i> a tu
          proyecto.</li>
        <li>Refresca tu propio proyecto en Eclipse (F5).</li>
      </ul>
      <p>Para modificar el código Java o XML de Addons:</p>
      <ul>
        <li>Modifica el código <i>Addon/src</i> o <i>Addons/xava</i>. Estas no
          son carpetas de código fuente para Eclipse, por lo que el Eclipse no
          las compila.</li>
        <li>Ejecuta la tarea Ant <i>buildAddons</i> en <i>OpenXava/build.xml</i>.
          Esto compila el código Java de Addons y copia su código XML.</li>
        <li>Refresca el proyecto Addons en Eclipse (F5).<br>
        </li>
        <li>Ejecuta la tarea Ant <i>actualizarOX</i> del <i>build.xml</i> de
          tu propio proyecto. </li>
        <li>Refresca tu propio proyecto en Eclipse (F5).</li>
      </ul>
      <p>Para modificar JSP/HTML/JavaScript/CSS:</p>
      <ul>
        <li>Modifica el código en <i>OpenXava/web</i>.<br>
        </li>
        <li>Ejecuta la tarea Ant <i>actualizarOX</i> del <i>build.xml</i> de
          tu propio proyecto. Esto copia todos los recursos web a tu proyecto.</li>
      </ul>
      <p></p>
      Desde v6.4 aunque todavía puedes navegar al código OpenXava desde tu
      propio código dentro de Eclipse, no puedes editar el código directamente,
      es de solo lectura. Por tanto, has de buscar la clase en cuestión en <i>OpenXava/src</i>
      tu mismo, modificarla y seguir los pasos de arriba.<br>
      <h2 id="toc2">Hasta v6.3.2</h2>
      Para modificar el código Java, XML o archivos i18n de OpenXava:
      <ul>
        <li>Modifica el código en <i>OpenXava/src</i>, <i>OpenXava/xava</i> o
          <i>OpenXava/i18n</i>. </li>
        <li>Pulsa el botón <i>Build All</i> o Ctrl-B.</li>
        <li>Ejecuta la tarea Ant <i>actualizarOX</i> del <i>build.xml</i> de
          tu propio proyecto. Esto crea un nuevo <i>openxava.jar</i> en tu
          proyecto.</li>
        <li>Refresca tu propio proyecto en Eclipse (F5).</li>
      </ul>
      <p>Para modificar el código Java o XML de Addons:</p>
      <ul>
        <li>Modifica el código en <i>Addon/src</i> o <i>Addons/xava</i>. </li>
        <li>Pulsa el botón <i>Build All</i> o Ctrl-B.</li>
        <li>Ejecuta la tarea Ant <i>actualizarOX</i> del <i>build.xml</i> de
          tu propio proyecto. </li>
        <li>Refresca tu propio proyecto en Eclipse (F5).</li>
      </ul>
      <p>Para modificar JSP/HTML/JavaScript/CSS:</p>
      <ul>
        <li>Modifica el código en <i>OpenXava/web</i>.<br>
        </li>
        <li>Ejecuta la tarea Ant <i>actualizarOX</i> del <i>build.xml</i> de
          tu propio proyecto. Esto copia todos los recursos web a tu proyecto.</li>
      </ul>
      <p></p>
    </div>
  </body>
</html>
