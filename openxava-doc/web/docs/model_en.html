<html>
  <!-- tmr -->
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Model - OpenXava</title>
    <link rel="stylesheet" href="static/style.css" type="text/css">
    <link rel="stylesheet" href="highlight/highlight.css">
    
    <link rel="stylesheet" href="highlight/highlightjs-copy.css"><script src="highlight/highlight.js"></script>
    
    <script src="highlight/highlightjs-copy.js"></script><script>window.addEventListener('DOMContentLoaded',function(){hljs.addPlugin(new CopyButtonPlugin({ autohide: false }));hljs.highlightAll();});</script>
  </head>
  <body>
    <div class="wiki" id="content_view" style="display: block;">
      <h1 id="toc0"><a name="Model"></a> <span id="breadcrumbs"> <span id="openxava">
            <a href="https://www.openxava.org/"> <span>o</span>pen<span>x</span>ava
              </a> </span> / <a href="index_en.html">documentation</a> / </span>
        Model </h1>
      <strong>Reference guide</strong>: <strong>Model</strong> | <a class="wiki_link"

        href="view_en.html">View</a> | <a class="wiki_link" href="tab_en.html">Tabular
        data</a> | <a class="wiki_link" href="mapping_en.html">Object/relational
        mapping</a> | <a class="wiki_link" href="controllers_en.html">Controllers</a>
      | <a class="wiki_link" href="application_en.html">Application</a> | <a class="wiki_link"

        href="customizing_en.html">Customizing</a>
      <hr>
      <div id="toc">
        <h1 class="nopad">Table of contents</h1>
        <div style="margin-left: 1em;"><a href="#Model">Model</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Business%20Component">Business
            Component</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Entity">Entity</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Embeddable%20classes">Embeddable
            classes</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Properties">Properties</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Stereotype">Stereotype</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-IMAGES_GALLERY%20stereotype">IMAGES_GALLERY
            stereotype</a></div>
        <div style="margin-left: 3em;"><a href="#files">File (new in v5.0) and
            Files (new in v5.1)<br>
          </a></div>
        <div style="margin-left: 4em;"><a href="#Model-Properties-FILE%20%28new%20in%20v5.0%29//%20and%20FILES%20//%28new%20in%20v5.1%29%20stereotypes-Storage%20in%20File%20System">Storage
            in File System</a></div>
        <div style="margin-left: 4em;"><a href="#Model-Properties-FILE%20%28new%20in%20v5.0%29//%20and%20FILES%20//%28new%20in%20v5.1%29%20stereotypes-Storage%20in%20Database">Storage
            in Database</a></div>
        <div style="margin-left: 4em;"><a href="#manage-files-programmatically">Manage
            files programmatically</a></div>
        <div style="margin-left: 3em;"><a href="#discussion">Discussion (new in
            v5.6)</a></div>
        <div style="margin-left: 3em;"><a href="#coordinates">Coordinates (new
            in v6.6)</a></div>
        <div style="margin-left: 3em;"><a href="#handwritten-signature">Handwritten signature (new in
            v7.6)</a></div>
        <div style="margin-left: 3em;"><a href="#masks">Mask (new in v7.1)<br>
          </a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Concurrency%20and%20version%20property">Concurrency
            and version property</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Enums">Enums</a></div>
        <div style="margin-left: 3em;"><a href="#enums-with-icon">Enums with
            icon (new in v6.3)</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Calculated%20properties">Calculated
            properties</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Formula%20%28new%20in%20v3.1.4%29">Formula
            (new in v3.1.4)</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Default%20value%20calculator">Default
            value calculator</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Default%20values%20on%20create">Default
            values on create</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Property%20validator">Property
            validator</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Default%20validator%20%28new%20in%20v2.0.3%29">Default
            validator (new in v2.0.3)</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Properties-Calculation%20%28new%20in%20v5.7%29">Calculation
            (new in v5.7)</a></div>
        <div style="margin-left: 2em;"><a href="#Model-References">References</a></div>
        <div style="margin-left: 3em;"><a href="#Model-References-Default%20value%20calculator%20in%20references">Default
            value calculator in references</a></div>
        <div style="margin-left: 3em;"><a href="#Model-References-Using%20references%20as%20key">Using
            references as key</a></div>
        <div style="margin-left: 3em;"><a href="#Model-References-Embedded%20reference">Embedded
            reference</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Collections">Collections</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Collections-Entity%20collections">Entity
            collections</a></div>
        <div style="margin-left: 3em;"><a href="#collections-with-condition">Collections
            with condition</a></div>
        <div style="margin-left: 3em;"><a href="#calculated-collections">Calculated
            collections</a></div>
        <div style="margin-left: 3em;"><a href="#many-to-many-collections">Many-to-many
            collections</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Collections-Embedded%20collections">Embedded
            collections</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Collections-Element%20collections%20%28new%20in%20v5.0%29">Element
            collections (new in v5.0)</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Collections-Lists%20with%20@OrderColumn%20%28new%20in%20v5.3%29">Lists
            with @OrderColumn (new in v5.3)</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Methods">Methods</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Finders">Finders</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Entity%20validator">Entity
            validator</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Remove%20validator">Remove
            validator</a></div>
        <div style="margin-left: 2em;"><a href="#Model-JPA%20callback%20methods">JPA
            callback methods</a></div>
        <div style="margin-left: 2em;"><a href="#Model-OX%20callback%20methods%20%28new%20in%20V4.0.1%29">OX
            callback methods (new in V4.0.1)</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Inheritance">Inheritance</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Composite%20key">Composite
            key</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Composite%20key-Id%20class">Id
            class</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Composite%20key-Embedded%20id">Embedded
            id</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Bean%20Validation">Bean
            Validation</a></div>
        <div style="margin-left: 3em;"><a href="#Model-Bean%20Validation-@AssertTrue">@AssertTrue</a></div>
        <div style="margin-left: 2em;"><a href="#Model-Hibernate%20Validator%20%28new%20in%20v3.0.1%29">Hibernate
            Validator (new in v3.0.1)</a></div>
      </div>
      The model layer in an object oriented application contains the business
      logic, that is the structure of the data and all the calculations,
      validations and processes associated to this data.<br>
      OpenXava is a model oriented framework where the model is the most
      important, and the rest (e.g. user interface) depends on it.<br>
      The way to define the model in OpenXava is using plain Java classes
      (although a <a class="wiki_link" href="model-xml_en.html">XML version</a>
      is also available). OpenXava generates a full featured application from
      your model definition.<br>
      <h2 id="toc1"><a name="Model-Business Component"></a>Business Component</h2>
      The basic unit to create an OpenXava application is the business
      component. A business component is defined using a Java class called <em>Entity</em>.
      This class is a regular EJB3 entity, or in other words, a <a class="wiki_link_ext"

        href="http://en.wikipedia.org/wiki/Plain_Old_Java_Object" rel="nofollow">POJO</a>
      class with annotations that follows the <a class="wiki_link_ext" href="http://en.wikipedia.org/wiki/Java_Persistence_API"

        rel="nofollow">Java Persistence API</a> (JPA) standard.<br>
      JPA is the Java standard for persistence, that is, for objects that store
      its state in a database. If you know how to develop using POJOs with JPA,
      you already know how to develop OpenXava applications.<br>
      Using a simple Java class you can define a Business Component with:<br>
      <ul>
        <li><strong>Model</strong>: Data structure, validations, calculations,
          etc.</li>
        <li><strong><a class="wiki_link" href="view_en.html">View</a></strong>:
          How the model can be shown to the user.</li>
        <li><strong><a class="wiki_link" href="tab_en.html">Tabular data</a></strong>:
          How the data of the component is displayed in list mode (in tabular
          format).</li>
        <li><strong><a class="wiki_link" href="mapping_en.html">Object/relational
              mapping</a></strong>: How to store and retrieve the object state
          from database.</li>
      </ul>
      This chapter explains how to define the model part, that is, all about
      structure, validations, calculations, etc.<br>
      <h2 id="toc2"><a name="Model-Entity"></a>Entity</h2>
      In order to define the model part you have to define a Java or <a class="wiki_link"

        href="groovy_en.html">Groovy</a> <em>(since v4m6)</em> class with
      annotations. In addition to its own annotations, OpenXava supports
      annotations from <a class="wiki_link_ext" href="http://java.sun.com/javaee/technologies/persistence.jsp"

        rel="nofollow">JPA</a>, <a class="wiki_link_ext" href="http://validator.hibernate.org/"

        rel="nofollow">Hibernate Validator</a> and <a class="wiki_link_ext" href="http://annotations.hibernate.org/"

        rel="nofollow">Hibernate Annotations</a>. This Java class is an entity,
      that is, a persistent class that represents a business concept.<br>
      In this chapter JPA is used to indicate that it's a standard Java
      Persistent API annotation, HV for indicating it's a Hibernate Validator
      annotation, HA for indicating it's a Hibernate Annotation and OX for
      indicating that is an annotation of OpenXava.<br>
      This is the syntax for an entity:<br>
      <pre><code class="language-java">@Entity // 1
@EntityValidator // 2
@RemoveValidator // 3
public class EntityName { // 4
 // Properties // 5
 // References // 6
 // Collections // 7
 // Methods // 8
 // Finders // 9
 // Callback methods // 10
}</code></pre>
      <ol>
        <li><strong>@Entity</strong> (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Entity.html"

            rel="nofollow">JPA</a>, one, required): Indicates that this class is
          a JPA entity, in other words, its instances will be persistent
          objects.</li>
        <li><strong><a class="wiki_link" href="#Model-Entity%20validator">@EntityValidator</a></strong>
          (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/EntityValidator.html"

            rel="nofollow">OX</a>, several, optional): Executes a validation at
          model level. This validator can receive the value of various model
          properties. To validate a single property it is better to use a
          property level validator.</li>
        <li><strong><a class="wiki_link" href="#Model-Remove%20validator">@RemoveValidator</a></strong>
          (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/RemoveValidator.html"

            rel="nofollow">OX</a>, several, optional): It's executed before
          removal, and can deny the object removing.</li>
        <li><strong>Class declaration</strong>: As a regular Java class. You can
          use <em>extends</em> and <em>implements</em>.</li>
        <li><strong><a class="wiki_link" href="#Model-Properties">Properties</a></strong>:
          Regular Java properties. They represent the main state of the object.</li>
        <li><strong><a class="wiki_link" href="#Model-References">References</a></strong>:
          References to other entities or embeddable classes.</li>
        <li><strong><a class="wiki_link" href="#Model-Collections">Collections</a></strong>:
          Collections of references to other entities or embeddable classes.</li>
        <li><strong><a class="wiki_link" href="#Model-Methods">Methods</a></strong>:
          Java methods with the business logic.</li>
        <li><strong><a class="wiki_link" href="#Model-Finders">Finders</a></strong>:
          Finder methods are static method that do searches using JPA query
          facilities.</li>
        <li><strong><a class="wiki_link" href="#Model-JPA%20callback%20methods">Callback
              methods</a></strong>: JPA callbacks methods to insert logic on
          creating, modifying, loading, removing, etc.</li>
      </ol>
      <h2 id="toc3"><a name="Model-Embeddable classes"></a>Embeddable classes</h2>
      As stated in JPA specification:<br>
      <em>"An entity may use other fine-grained classes to represent entity
        state. Instances of these classes, unlike</em><br>
      <em>entity instances themselves, do not have persistent identity. Instead,
        they exist only as embedded objects</em><br>
      <em>of the entity to which they belong. Such embedded objects belong
        strictly to their owning entity, and are</em><br>
      <em>not sharable across persistent entities."</em><br>
      The embeddable class syntax is:<br>
      <pre><code class="language-java">@Embeddable // 1
public class EmbeddableName { // 2
 // Properties // 3
 // References // 4
 // Methods // 5
}
</code></pre>
      <ol>
        <li><strong>@Embeddable</strong> (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Embeddable.html"

            rel="nofollow">JPA</a>, one, required): Indicates that this class is
          an embeddable class of JPA, in other words, its instances will be part
          of persistent objects.</li>
        <li><strong>Class declaration</strong>: As a regular Java class. You can
          use <em>extends</em> and <em>implements</em>.</li>
        <li><strong><a class="wiki_link" href="#Model-Properties">Properties</a></strong>:
          Regular Java properties.</li>
        <li><strong><a class="wiki_link" href="#Model-References">References</a></strong>:
          References to entities or embeddable classes.</li>
        <li><strong><a class="wiki_link" href="#Model-Methods">Methods</a></strong>:
          Java methods with the business logic.</li>
      </ol>
      <h2 id="toc4"><a name="Model-Properties"></a>Properties</h2>
      A property represents the state of an object that can be read and in some
      cases updated. The object does not have the obligation to store physically
      the property data, it only has to return it when required.<br>
      The syntax to define a property is:<br>
      <pre><code class="language-java">@Stereotype                                                                //  1
@Column(length=) @Column(precision=) @Max @Length(max=) @Digits(integer=)  //  2
@Digits(integer=) @Digits(fraction=)                                       //  3
@Required @Min @Range(min=) @Length(min=)                                  //  4
@Id                                                                        //  5
@Hidden                                                                    //  6
@SearchKey                                                                 //  7
@Version                                                                   //  8
@Formula                                                                   //  9  New in v3.1.4
@Calculation                                                               // 10  New in v5.7
@DefaultValueCalculator                                                    // 11
@PropertyValidator                                                         // 12
private type propertyName;                                                 // 13
public type getPropertyName() { ... }                                      // 13
public void setPropertyName(type newValue) { ... }                         // 13
</code></pre>
      <ol>
        <li><strong><a class="wiki_link" href="model_en.html#Model-Properties-Stereotype">@Stereotype</a></strong>
          (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Stereotype.html"

            rel="nofollow">OX</a>, optional): Allows to specify a special
          behavior for some properties.</li>
        <li><strong>@Column(length=)</strong> (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Column.html"

            rel="nofollow">JPA</a>), <strong>@Max</strong> (<a class="wiki_link_ext"

            href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/javax/validation/constraints/Max.html"

            rel="nofollow">BV</a>), <strong>@Length(max=)</strong> (<a class="wiki_link_ext"

            href="http://docs.jboss.org/hibernate/validator/5.1/api/org/hibernate/validator/constraints/Length.html"

            rel="nofollow">HV</a>), <strong>@Digits(integer=)</strong> (<a class="wiki_link_ext"

            href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/javax/validation/constraints/Digits.html"

            rel="nofollow">BV</a>) (optional, usually you only use one of them):
          Length in characters of property, except in <em>@Max</em> case that
          is the max value. Useful to generate user interfaces. If you do not
          specify the size then a default value is assumed. This default value
          is associated to the stereotype or type and it's obtained from <em>default-size.xml</em>.
          <em>@Max</em> and <em>@Digits</em> are from Bean Validation <em>(new
            in v4.1)</em> or Hibernate Validator <em>(until v5.2.x)</em>.</li>
        <li><strong>@Column(scale=)</strong> (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Column.html"

            rel="nofollow">JPA</a>), <strong>@Digits(fraction=)</strong> (<a class="wiki_link_ext"

            href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/javax/validation/constraints/Digits.html"

            rel="nofollow">BV</a>): Scale (size of decimal part) of property.
          Only applies to numeric properties. If you do not use <em>@Column</em>
          or <em>@Digits</em> a default value is assumed, if you use <em>@Column</em>
          without <i>length</i>, without <i>precision</i> and without <em>scale</em>
          a default value is assumed for <i>scale</i>, if you use <em>@Column</em>
          with <i>length</i> or <i>precision</i> and without <em>scale</em> a
          0 is assumed for <i>scale (new in v7.0.6 </i>before a default value
          was assumed<i>), </i>if you use <em>@Digits</em> without <em>fraction</em>,
          0 is assumed. The default value is associated to the stereotype or
          type and is obtained from <em>default-size.xml</em>. <em>@Digits</em>
          is from Bean Validation <em>(new in v4.1)</em> or Hibernate Validator
          <em>(until v5.2.x)</em>.</li>
        <li><strong>@Required</strong> (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Required.html"

            rel="nofollow">OX</a>), <strong>@Min</strong> (<a class="wiki_link_ext"

            href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/javax/validation/constraints/Min.html"

            rel="nofollow">BV</a>), <strong>@Range(min=)</strong> (<a class="wiki_link_ext"

            href="http://docs.jboss.org/hibernate/validator/5.1/api/org/hibernate/validator/constraints/Range.html"

            rel="nofollow">HV</a>), <strong>@Length(min=)</strong> (<a class="wiki_link_ext"

            href="http://docs.jboss.org/hibernate/validator/5.1/api/org/hibernate/validator/constraints/Length.html"

            rel="nofollow">HV</a>) (optional, usually you only use one of them):
          Indicates if this property is required. In the case of <em>@Min</em>,
          <em>@Range</em> and <em>@Length</em> you have to put a value greater
          than zero for <em>min</em> in order to assume that the property is
          required. By default a property is required for key properties hidden
          <em>(new in v2.1.3)</em> and false in all the other cases. On saving
          OpenXava verifies if the required properties are present. If this is
          not the case, then the saving is not done and a validation error list
          is returned. The logic to determine if a property is present or not
          can be configured by creating a file called <em>validators.xml</em>
          in your project. You can see the syntax in <a href="https://github.com/openxava/openxava/blob/master/openxava/src/main/resources/xava/default-validators.xml"><em>openxava/src/main/resources/xava/default-validators.xml</em></a>.
          <em>@Required</em> and <em>@Min</em> are <a class="wiki_link" href="model_en.html#Model-Bean%20Validation">Bean
            Validation</a> constraints since v5.3 and they were <a class="wiki_link"

            href="model_en.html#Model-Hibernate%20Validator%20%28new%20in%20v3.0.1%29">Hibernate
            Validator</a> constraints until v5.2.x.</li>
        <li><strong>@Id</strong> (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Id.html"

            rel="nofollow">JPA</a>, optional): Indicates that this property is
          part of the key. At least one property (or reference) must be key. The
          combination of key properties (and key references) must be mapped to a
          group of database columns that do not have duplicate values, typically
          the primary key.</li>
        <li><strong>@Hidden</strong> (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Hidden.html"

            rel="nofollow">OX</a>, optional): A hidden property has a meaning
          for the developer but not for the user. The hidden properties are
          excluded when the automatic user interface is generated. However at
          Java code level they are present and fully functional. Even if you put
          it explicitly into a view the property will be shown in the user
          interface.</li>
        <li><strong>@SearchKey</strong> (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/SearchKey.html"

            rel="nofollow">OX</a>, optional): The search key properties are used
          by the user as key for searching objects. They are editable in user
          interface of references allowing to the user type its value for
          searching. OpenXava uses the <em>@Id</em> properties for searching by
          default, and if the id properties are hidden then it uses the first
          property in the view. With <em>@SearchKey</em> you can choose
          explicitly the properties for searching.</li>
        <li><strong><a class="wiki_link" href="#Model-Properties-Concurrency%20and%20version%20property">@Version</a></strong>
          (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Version.html"

            rel="nofollow">JPA</a>, optional): A version property is used for
          optimistic concurrency control. If you want control concurrency you
          only need to have a property marked as <em>@Version</em> in your
          entity. Only a single version property should be used per entity. The
          following types are supported for version properties: <em>int,
            Integer, short, Short, long, Long, Timestamp</em>. The version
          properties are considered hidden.</li>
        <li><strong><a class="wiki_link" href="model_en.html#Model-Properties-Formula%20%28new%20in%20v3.1.4%29">@Formula</a></strong>
          (<a class="wiki_link_ext" href="http://docs.jboss.org/hibernate/stable/annotations/api/org/hibernate/annotations/Formula.html"

            rel="nofollow">HA</a>, optional): <em>(New in v3.1.4)</em> To
          calculate the value of the property using the database. It must be a
          valid SQL fragment.</li>
        <li><strong><a class="wiki_link" href="model_en.html#Model-Properties-Calculation%20%28new%20in%20v5.7%29">@Calculation</a></strong>
          (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Calculation.html"

            rel="nofollow">OX</a>, one, optional): <em>(New in v5.7)</em>
          Arithmetic expression to do the calculation for the property. The
          calculation is done in the user interface when any operand changes.</li>
        <li><strong><a class="wiki_link" href="model_en.html#Model-Properties-Default%20value%20calculator">@DefaultValueCalculator</a></strong>
          (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/DefaultValueCalculator.html"

            rel="nofollow">OX</a>, one, optional): Implements the logic to
          calculate the default (initial) value for this property. A property
          with @DefaultValueCalculator has <em>setter</em> and it is
          persistent.</li>
        <li><strong><a class="wiki_link" href="model_en.html#Model-Properties-Property%20validator">@PropertyValidator</a></strong>
          (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValidator.html"

            rel="nofollow">OX</a>, several, optional): Implements the validation
          logic to execute on this property before modifying or creating the
          object that contains it.</li>
        <li><strong>Property declaration</strong>: A regular Java property
          declaration with its getters and setters. You can create a calculated
          property using only a getter with no field nor setter. Any type legal
          for JPA is available, you only need to provide a Hibernate Type to
          allow saving in database and an OpenXava editor to render as HTML.</li>
      </ol>
      <h3 id="toc5"><a name="Model-Properties-Stereotype"></a>Stereotype</h3>
      A stereotype (<em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Stereotype.html"

          rel="nofollow">@Stereotype</a></em>) is the way to determine a
      specific behavior of a type. For example, a name, a comment, a
      description, etc. all correspond to the Java type java.lang.String but you
      surely wish validators, default sizes, visual editors, etc. to be
      different in each case and you need to tune finer; you can do this
      assigning a stereotype to each case. That is, you can have the next
      sterotypes NAME, MEMO or DESCRIPTION and assign them to your properties.</div>
    <div class="wiki" style="display: block;">Since v6.6 you can use Java
      annotations instead of stereotypes (that is you can use <i>@File</i>
      instead of <i>@Stereotype("FILE")</i>), so the compiler assures that the
      code is well write and moreover each annotation can include its specific
      attributes.</div>
    <div class="wiki" style="display: block;"> OpenXava comes with these generic
      stereotypes and since v6.6 with their corresponding annotation:<br>
      <ul>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Money.html">@Money</a>
            (new in v6.6), </i>MONEY, DINERO</li>
        <li>PHOTO, IMAGEN, FOTO, IMAGE (since v6.6 you can use <i>@File</i> as
          alternative that is more flexible and performant)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/TextArea.html">@TextArea</a>
            (new in v6.6), </i>MEMO, TEXT_AREA, TEXTO_GRANDE</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Label.html">@Label</a>
            (new in v6.6), </i>LABEL, ETIQUETA</li>
        <li>BOLD_LABEL, ETIQUETA_NEGRITA</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/StringTime.html">@StringTime</a>
            (new in v6.6), </i>TIME, HORA (since v7.3 you can use <i>LocalTime</i>
          type property instead of <i>String</i>. It has a more sophisticated
          editor and maps to a TIME type data in the database)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/DateTime.html">@DateTime</a>
            (new in v6.6), </i>DATETIME, FECHAHORA (since v7.4 you can use <i>LocalDateTime</i>
          type property instead of <i>Date</i> with <i>@DateTime/Stereotype("DATETIME")</i>)</li>
        <li>IMAGES_GALLERY, GALERIA_IMAGENES (<a class="wiki_link" href="#Model-Properties-IMAGES_GALLERY%20stereotype">setup
            instructions</a>) (since v6.6 you can use <i>@Files</i> as
          alternative)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/ZerosFilled.html">@ZerosFilled</a>
            (new in v7.1), </i>ZEROS_FILLED, RELLENADO_CON_CEROS</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/HtmlText.html">@HtmlText</a>
            (new in v6.6), </i>HTML_TEXT, TEXTO_HTML (text with editable
          format)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/HtmlText.html">@HtmlText(simple=true)</a>
            (new in v6.6), </i>SIMPLE_HTML_TEXT, TEXTO_HTML_SIMPLE (<em>new in
            v5.6</em>, like HTML_TEXT with a simplified UI)</li>
        <li>IMAGE_LABEL, ETIQUETA_IMAGEN (image depending on property content)</li>
        <li><i>@Email</i> (from <i>javax.validation.constraints</i>) <i>(new
            in v6.6)</i>, EMAIL</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Telephone.html">@Telephone</a>
            (new in v6.6), </i>TELEPHONE, TELEFONO</li>
        <li><i>@URL</i> (from <i>org.hibernate.validator.constraints</i>) <i>(new
            in v6.6), </i>WEBURL</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/IP.html">@IP</a>
            (new in v6.6), </i>IP</li>
        <li><i>@ISBN</i> (from <i>org.hibernate.validator.constraints</i>) <i>(new
            in v6.6), </i>ISBN</li>
        <li><i>@CreditCardNumber</i> (from <i>org.hibernate.validator.constraints</i>)
          <i>(new in v6.6), </i>CREDIT_CARD, TARJETA_CREDITO</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/EmailList.html">@EmailList</a>
            (new in v6.6), </i>EMAIL_LIST, LISTA_EMAIL</li>
        <li>DOCUMENT_LIBRARY, LIBRERIA_DOCUMENTOS (<em>new in v4m6</em>, <i>until
            v6.6.3</i>, it only works inside Liferay)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Password.html">@Password</a>
            (new in v6.6), </i>PASSWORD, CONTRASENA (<em>new in v4.1</em>)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/MAC.html">@MAC</a>
            (new in v6.6), </i>MAC <em>(new in v4.8)</em></li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/File.html">@File</a>
            (new in v6.6)</i>, FILE, ARCHIVO (<em>new in v5.0</em>) (<a class="wiki_link"

            href="#files">setup instructions</a>)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Files.html">@Files</a>
            (new in v6.6), </i>FILES, ARCHIVOS (<em>new in v5.1</em>) (<a class="wiki_link"

            href="#files">setup instructions</a>)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Icon.html">@Icon</a>
            (new in v6.6), </i>ICON, ICONO (<em>new in v5.5</em>)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Discussion.html">@Discussion</a>
            (new in v6.6), </i>DISCUSSION, DISCUSION (<em>new in v5.6</em>) (<a

            class="wiki_link" href="#discussion">setup instructions</a>)</li>
        <li><i><a href="https://openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Coordinates.html">@Coordinates</a>,
          </i>COORDINATES, COORDENADAS (<i>new in v6.6</i>) (<a class="wiki_link"

            href="#coordinates">setup instructions</a>)</li>
        <li><i>@HandwrittenSignature, </i>HANDWRITTEN_SIGNATURE, FIRMA_MANUSCRITA (<i>new in v7.6</i>) (<a class="wiki_link"
            href="#handwritten-signature">setup instructions</a>)</li>
      </ul>
      <strong>NOTE</strong>: Most of the above Stereotypes return a String, <u>but
        not all</u>! Rather than list the exceptions here, reference the file <a

        href="https://github.com/openxava/openxava/blob/master/openxava/src/main/resources/xava/stereotype-type-default.xml"><i>openxava/src/main/resources/xava/stereotype-type-default.xml</i></a>
      to keep up to date with each Stereotype proper return type.</div>
    <div class="wiki" style="display: block;">Apart of the above stereotype like
      annotation you can annotate properties with <a href="view_en.html#View-Property%20customization">view
        related annotations</a>.</div>
    <div class="wiki" style="display: block;"> <br>
      Now you will learn how to define your own stereotype. You will create one
      called PERSON_NAME to represent names of persons.<br>
      Edit (or create) the file <em>editors.xml</em> in your folder <i>src/main/resources/xava</i>
      (just <em>xava</em> before v7). And add:<br>
      <pre><code class="language-xml">&lt;editor url="personNameEditor.jsp"&gt;
    &lt;for-stereotype stereotype="PERSON_NAME"/&gt;
    &lt;for-annotation annotation="com.yourcompany.yourapp.annotations.PersonName"/&gt; &lt;!-- New in v6.6 --&gt;
&lt;/editor&gt;
</code></pre> This way you define the editor to render for editing and
      displaying properties of stereotype PERSON_NAME. Note as since v6.6 you
      can define an annotation instead of an stereotype, you can also use both.<br>
      Furthermore it is useful to indicate the default size; you can do this by
      editing <em>default-size.xml</em> of your project:<br>
      <pre><code class="language-xml">&lt;for-stereotype name="PERSON_NAME" size="40"/&gt;
&lt;for-annotation class="com.yourcompany.yourapp.annotations.PersonName" size="40"/&gt; &lt;!-- New in v6.6 --&gt;
</code></pre> Thus, if you do not put the size in a property of type PERSON_NAME
      (or <i>@PersonName</i>) a value of 40 is assumed.<br>
      Not so common is changing the validator for required, but if you wish to
      change it you can do it adding to <em>validators.xml</em> of your project
      the next definition:<br>
      <pre><code class="language-xml">&lt;required-validator&gt;
    &lt;validator-class class="org.openxava.validators.NotBlankCharacterValidator"/&gt;
    &lt;for-stereotype stereotype="PERSON_NAME"/&gt;
    &lt;for-annotation annotation="com.yourcompany.yourapp.annotations.PersonName"/&gt; &lt;!-- New in v6.6 --&gt;
&lt;/required-validator&gt;
</code></pre> Now everything is ready to define properties of stereotype
      PERSON_NAME:<br>
      <pre><code class="language-java">@Stereotype("PERSON_NAME")
private String name;
</code></pre> In this case a value of 40 is assumed as size, String as type and
      the <em>NotBlankCharacterValidator</em> validator is executed to verify
      if it is required.</div>
    <div class="wiki" style="display: block;"><br>
    </div>
    <div class="wiki" style="display: block;">Since v6.6 you can use a Java
      annotation instead of a stereotype, in this way:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@PersonName
private String name;
</code></pre> </div>
    <div class="wiki" style="display: block;">Obviously, you have to write the
      code for <i>@PersonName</i> annotation. Look at <a href="customizing_en.html#editors-for-annotations">customizing
        doc</a> to learn more about defining your own annotations.<br>
      <h3 id="toc6"><a name="Model-Properties-IMAGES_GALLERY stereotype"></a>IMAGES_GALLERY
        stereotype</h3>
      <i>Since v6.6 you can use <a href="#files">@Files</a> instead because now
        @Files shows images preview of uploaded files. @Files has more options
        than IMAGES_GALLERY and allows several persistence mechanism.</i></div>
    <div class="wiki" style="display: block;">If you want a property of your
      component to hold a gallery of images, you only have to declare your
      property with the IMAGES_GALLERY stereotype, in this way:<br>
      <pre><code class="language-java">@Stereotype("IMAGES_GALLERY")
private String photos;</code></pre>
      Furthermore, in the mapping part you have to map your property to a table
      column suitable to store a String with a length of 32 characters
      (VARCHAR(32)).<br>
      And everything is done.<br>
      <strong>IMPORTANT</strong><br>
      In order to support this stereotype you need to setup the system
      appropriately for your application.<br>
      First, create a table in your database to store the images:<br>
      <pre><code class="language-sql">CREATE TABLE IMAGES (
 ID VARCHAR(32) NOT NULL PRIMARY KEY,
 GALLERY VARCHAR(32) NOT NULL,
 IMAGE BLOB);
CREATE INDEX IMAGES01
 ON IMAGES (GALLERY);</code></pre>
      The type of IMAGE column can be a more suitable one for your database to
      store byte [] (for example LONGVARBINARY) .<br>
      For PostgreSQL, the value to use instead of BLOB is BYTEA.<br>
      Also, it appears that the default configuration will create the IMAGES
      table with the VARCHARS at 255 length. Go ahead and drop and re-create the
      table as above and all should be well.</div>
    <div class="wiki" style="display: block;"> Verify that <em>persistence.xml</em>
      contains the <em>GalleryImage</em> entity, if not add it:<br>
      <div class="wiki">
        <pre><code class="language-xml">&lt;persistence-unit name="default"&gt;
 &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
 &lt;non-jta-data-source&gt;java:comp/env/jdbc/OpenXavaTestDS&lt;/non-jta-data-source&gt;
 &lt;class&gt;org.openxava.session.GalleryImage&lt;/class&gt; &lt;!-- ADD THIS LINE --&gt;
 &lt;class&gt;org.openxava.web.editors.DiscussionComment&lt;/class&gt; 
  ...
&lt;/persistence-unit&gt;
</code></pre>
        Note that we added <em>&lt;class&gt;org.openxava.session.GalleryImage&lt;/class&gt;</em>.</div>
      <div class="wiki">If you're using an OpenXava version older than 7.0 you
        need to define the mapping in your <em>persistence/hibernate.cfg.xml</em>
        file, thus:</div>
      <pre><code class="language-xml">&lt;hibernate-configuration&gt;
 &lt;session-factory&gt;
 ...
 &lt;mapping resource="GalleryImage.hbm.xml"/&gt;
 ...
 &lt;/session-factory&gt;
&lt;/hibernate-configuration&gt;</code></pre>
      After this you can use the IMAGES_GALLERY stereotype in all components of
      your application.<br>
      <h3 id="toc7"><a name="files"></a>File <em>(new in v5.0)</em> and Files <em>(new
          in v5.1)</em></h3>
      If you want a property of your component to attach a file, you only have
      to declare your property with the <i>@File</i> annotation <i>(new in
        v6.6)</i>, in this way:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@File
@Column(length=32)
private String document;
</code></pre> </div>
    <div class="wiki" style="display: block;">Or if you use a version previous
      to 6.6 using the FILE stereotype, in this way:<br>
      <pre><code class="language-java">@Stereotype("FILE")
@Column(length=32)
private String document;
</code></pre>Use <i>@Files</i> <i>(new in v6.6)</i> for attaching multiple
      files:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@Files
@Column(length=32)
private String documents;
</code></pre> </div>
    <div class="wiki" style="display: block;">Or if you use a version previous
      to 6.6 use the FILES stereotype, thus:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@Stereotype("FILES")
@Column(length=32)
private String documents;
</code></pre>When you use the annotation version (<i>@File</i> or <i>@Files</i>)
      you can define attributes like <i>acceptFileTypes</i> or <i>maxFileSizeInKb</i>
      to restrict the files the user can upload. For example, with this code:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@File(acceptFileTypes="image/*", maxFileSizeInKb=90)
@Column(length=32)
private String photo;
</code></pre> </div>
    <div class="wiki" style="display: block;">The user can only upload images of
      90 Kb or less, and with this one:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@Files(acceptFileTypes="text/csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
@Column(length=32)
private String spreadsheets;
</code></pre> </div>
    <div class="wiki" style="display: block;">Only CSV and Excel files. As you
      can see in <i>acceptFileTypes</i> you put a <a href="https://docs.w3cub.com/http/basics_of_http/mime_types/complete_list_of_mime_types">list
        of mime types</a> separated by commas and you can use wildcards. </div>
    <div class="wiki" style="display: block;"><br>
    </div>
    <div class="wiki" style="display: block;"> OpenXava can be configured to
      store the files in the database or the file system.<br>
      <h4 id="toc8"><a name="Model-Properties-FILE (new in v5.0)// and FILES //(new in v5.1) stereotypes-Storage in File System"></a><strong>Storage
          in File System</strong></h4>
      It is the default and requires no additional configuration.<br>
      The storage directory is <strong>$HOME/oxfiles</strong> (GNU/Linux) or <strong>%USERPROFILE%\oxfiles</strong>
      (Windows). We can set a different directory using the <strong><em>filesPath</em></strong>
      property in <strong><em>xava.properties</em></strong>.<br>
      <h4 id="toc9"><a name="Model-Properties-FILE (new in v5.0)// and FILES //(new in v5.1) stereotypes-Storage in Database"></a><strong>Storage
          in Database</strong></h4>
      You need three additional settings:<br>
      <ul>
        <li>Set the <strong><em>filePersistorClass</em></strong> property in <strong><em>xava.properties</em></strong></li>
      </ul>
      <pre><code class="language-properties">filePersistorClass=org.openxava.web.editors.JPAFilePersistor
...</code></pre>
      <ul>
        <li>Modify the <strong><em>persistence.xml</em></strong></li>
      </ul>
      <pre><code class="language-xml">&lt;persistence-unit name="default"&gt;
 &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
 &lt;non-jta-data-source&gt;java:comp/env/jdbc/OpenXavaTestDS&lt;/non-jta-data-source&gt;
 &lt;class&gt;org.openxava.session.GalleryImage&lt;/class&gt;
 &lt;class&gt;org.openxava.web.editors.AttachedFile&lt;/class&gt;
  ...
&lt;/persistence-unit&gt;

        ...

&lt;persistence-unit name="junit"&gt;
 &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
 &lt;class&gt;org.openxava.web.editors.AttachedFile&lt;/class&gt;
 ....
&lt;/persistence-unit&gt;</code></pre>
      Note that you added <strong><em>&lt;class&gt;org.openxava.web.editors.AttachedFile&lt;/class&gt;</em></strong>
      both persistence units.<br>
      <ul>
        <li>When the database is generated, the table OXFILES is created:</li>
      </ul>
      <pre><code class="language-sql">CREATE TABLE OXFILES (
 ID VARCHAR(32) NOT NULL PRIMARY KEY,
 NAME VARCHAR(255),
 DATA LONGVARBINARY,
 LIBRARYID VARCHAR(32)
);</code></pre>
      You should check that the type of DATA column is the most suitable type
      for storing byte[] (in our case LONGVARBINARY).</div>
    <div class="wiki" style="display: block;">
      <h4 id="manage-files-programmatically">Manage files programmatically</h4>
      <p>Properties annotated with <i>@File, @Files, @HandwrittenSignature, Stereotype("FILE")</i>,
        <i>@Stereotype("FILES")</i> or <i>@Stereotype("HANDWRITTEN_SIGNATURE")</i> only store a 32-character identifier, not
        the file content. To access the content of the uploaded file from your
        own code, you need to use an <a href="https://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/web/editors/IFilePersistor.html"><i>IFilePersistor</i></a>
        obtained from <a href="https://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/web/editors/FilePersistorFactory.html"><i>FilePersistorFactory</i></a>,
        classes that you can find in the <a href="https://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/web/editors/package-summary.html"><i>org.openxava.web.editors</i></a>
        package. These classes work the same regardless of whether the files are
        stored in the file system, a database, or any other location.</p>
      <p>In the case of <i>@File</i>, <i>@HandwrittenSignature</i>, <i>@Stereotype("FILE")</i> or 
        <i>@Stereotype("HANDWRITTEN_SIGNATURE")</i>, the
        property directly stores the file ID. For example, if we have a property
        like this:</p>
      <p></p>
      <pre><code class="language-java">@File @Column(length=32)
String photo;
</code></pre>
      <p></p>
      <p>We can fill it with a file using our own code like this:</p>
      <pre><code class="language-java">import java.nio.file.*;

import org.openxava.actions.*;
import org.openxava.web.editors.*;

public class LoadPhotoAction extends ViewBaseAction {

    public void execute() throws Exception {
        // In this example we get the file from filesystem
        // but in your case you could get the file from any other place
        String filePath = "/home/me/images/myphoto.png";
        byte[] fileBytes = Files.readAllBytes(Paths.get(filePath));

        // An IFilePersistor to work with the file 
        IFilePersistor filePersistor = FilePersistorFactory.getInstance();

        // We create an AttachedFile object 
        AttachedFile file = new AttachedFile();
        file.setName("myphoto.png");
        file.setData(fileBytes);
		
        // This save the file 
        filePersistor.save(file);
		
        // After saved, the AttachedFile has its id populated
        // so we set it to the property in the view
        getView().setValue("photo", file.getId());
    }

}
</code></pre>
      <p>You create an <a href="https://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/web/editors/AttachedFile.html"><i>AttachedFile</i></a>
        and save it with an <a href="https://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/web/editors/IFilePersistor.html"><i>IFilePersistor</i></a>,
        then obtain the file ID to use it as the value for the property. The <i>photo</i>
        property stores the file ID.</p>
      <p>The reverse process, that is, obtaining and manipulating the file
        already in the <i>@File</i> property, would be like this:</p>
      <pre><code class="language-java">import java.nio.file.*;

import org.openxava.actions.*;
import org.openxava.web.editors.*;

public class SavePhotoAction extends ViewBaseAction {

    public void execute() throws Exception {
        // An IFilePersistor to work with the file
        IFilePersistor filePersistor = FilePersistorFactory.getInstance();
		
        // We get the photo id from the property
        String photoId = getView().getValueString("photo");
		
        // And find the AttachedFile with that id using the IFilePersistor
        AttachedFile file = filePersistor.find(photoId);
		
        // We get the name and the content from the AttachedFile
        String fileName = file.getName();
        byte[] fileBytes = file.getData();
		
        // In this example we save the file in the filesystem
        // but you could do anything you want with the file
        String filePath = "/home/me/images/" + fileName;
        Files.write(Paths.get(filePath), fileBytes);
    }

}
</code></pre>
      <p>You search for an <i>AttachedFile</i> using an <i>IFilePersistor</i>
        based on the photo ID you have in the property.</p>
      <p>Working with <i>@Files</i> or <i>@Stereotype(“FILES”)</i> is slightly
        different because, in this case, the property stores the library ID, not
        the file ID. A library is a group of files. Each file has its own ID,
        but they all share a common library ID. For example, with a property
        like this:</p>
      <pre><code class="language-java">@Files @Column(length=32)
String documents;
</code></pre>
      <p>We can populate it with multiple files using our own code like this:</p>
      <pre><code class="language-java">import java.nio.file.*;

import org.openxava.actions.*;
import org.openxava.web.editors.*;

public class LoadDocumentsAction 
    extends GenerateIdForPropertyBaseAction { // To use the generateIdForProperty() method

    public void execute() throws Exception {
        // In this example we're going to upload some files from the filesystem
        // but you could get the files or files content from any other place
        String basePath = "/home/me/documents/";
        String [] fileNames = {
            "limiting-data-by-user.pdf",
            "quick-start.odg"
        };

        // We need generate an id for the library first time or use the one
        // that already exists. This work is done for you by generateIdForProperty()
        // The generated id is left in the 'documents' property in the view
        String libraryId = generateIdForProperty("documents"); 
		
        // An IFilePersistor to work with the files
        IFilePersistor filePersistor = FilePersistorFactory.getInstance();
        for (String fileName: fileNames) {
            // For our example we get the file content from filesystem
            byte[] fileBytes = Files.readAllBytes(Paths.get(basePath + fileName));
			
            // We create an AttachedFile and fill it
            AttachedFile file = new AttachedFile();
            file.setLibraryId(libraryId); // The same libraryId for all files
            file.setName(fileName);
            file.setData(fileBytes);
			
            // Then save it using the IFilePersistor
            filePersistor.save(file);
        }
    }

}
</code></pre>
      <p>The trick is that we need to have a single library ID to assign to each
        of the files we are going to save. This ID is generated with <i>generateIdForProperty()</i>,
        which creates it if it doesn’t exist or returns it if it already does.
        If a new one is generated, it is assigned to the property in the view,
        so when the entity is saved, it will be saved with the correct library
        ID. The rest is simply a loop creating <i>AttachedFile</i> and saving
        them with <i>IFilePersistor</i>, assigning each one the same library
        ID.</p>
      <p>The opposite process, that is, retrieving and manipulating the files
        that are already in the <i>@Files</i> property, would be like this:</p>
      <pre><code class="language-java">import java.nio.file.*;
import java.util.*;

import org.openxava.actions.*;
import org.openxava.web.editors.*;

public class SaveDocumentsAction extends ViewBaseAction {

    public void execute() throws Exception {
        // An IFilePersistor to work with the files
        IFilePersistor filePersistor = FilePersistorFactory.getInstance();
		
        // For @Files the property stores the library id, not any file id
        String libraryId = getView().getValueString("documents");
		
        // We use findLibrary() of IFilePersistor to get a collection of files
        Collection&lt;AttachedFile&gt; files =filePersistor.findLibrary(libraryId);
        for (AttachedFile file: files) {
            // We get the name and content from the AttachedFile
            String fileName = file.getName();
            byte[] fileBytes = file.getData();
            String filePath = "/home/me/documents/" + fileName;
			
            // In our example we save in the filesystem, 
            // but in your case you can do whatever you want
            Files.write(Paths.get(filePath), fileBytes);
        }
    }

}
</code></pre>
      <p>Remember that for <i>@Files</i> in the property, the library ID is
        stored, not the file ID. From this ID, we use the <i>findLibrary()</i>
        method of <i>IFilePersistor</i> to get all the files associated with
        that library, i.e., that property. Then we loop through those files and
        process them as desired.</p>
      <h3 id="toc10"><a name="discussion"></a>Discussion <em>(new in v5.6)</em></h3>
      If you want a property of your component to contain a discussion thread,
      just like the ones in forums, trackers, blogs, etc. You only have to
      annotate your property with <i>@Discussion (new in v6.6)</i>, in this
      way:<br>
      <pre><code class="language-java">@Discussion
@Column(length=32)
private String discussion;
</code></pre> </div>
    <div class="wiki" style="display: block;">Or if you use a version previous
      to 6.6 using the DISCUSSION stereotype, thus:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@Stereotype("DISCUSSION")
@Column(length=32)
private String discussion;
</code></pre> </div>
    <div class="wiki" style="display: block;">Also if you want that when the
      entity is removed the associated discussion would be removed too, you have
      to add the next code to your entity:<br>
      <pre><code class="language-java">@PreRemove
private void removeDiscussion() {
    DiscussionComment.removeForDiscussion(discussion);
}</code></pre>
      Verify that <em>persistence.xml</em> contains the <em>DiscussionComment</em>
      entity, if not add it:<br>
      <pre><code class="language-xml">&lt;persistence-unit name="default"&gt;
 &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
 &lt;non-jta-data-source&gt;java:comp/env/jdbc/OpenXavaTestDS&lt;/non-jta-data-source&gt;
 &lt;class&gt;org.openxava.session.GalleryImage&lt;/class&gt;
 &lt;class&gt;org.openxava.web.editors.DiscussionComment&lt;/class&gt; &lt;!-- ADD THIS LINE --&gt;
  ...
&lt;/persistence-unit&gt;
</code></pre>
      Note that we added <em>&lt;class&gt;org.openxava.web.editors.DiscussionComment&lt;/class&gt;</em>.
      When the database is generated, the OXDISCUSSIONCOMMENTS table is created:<br>
      <pre><code class="language-sql">CREATE TABLE OXDISCUSSIONCOMMENTS (
    ID VARCHAR(32) NOT NULL,
    COMMENT CLOB(16777216),
    DISCUSSIONID VARCHAR(32),
    TIME TIMESTAMP,
    USERNAME VARCHAR(30),
    PRIMARY KEY (ID)
);

CREATE INDEX OXDISCUSSIONCOMMENTS_DISCUSSIONID_INDEX
    ON OXDISCUSSIONCOMMENTS (DISCUSSIONID);</code></pre>
      Check that the type for COMMENT column is the most suitable type for
      storing a large text (by default CLOB) in your database, if not just do an
      ALTER COLUMN to put a better type.<br>
      With Tomcat 6 you have to edit the class <em>org.openxava.web.editors.DiscussionComment</em>
      and remove the <em>@Lob</em> annotation from <em>comment</em> property.</div>
    <div class="wiki" style="display: block;">
      <h3><a name="coordinates"></a>Coordinates <em>(new in v6.6)</em></h3>
      A coordinates property allows your user to choose a point in a map and
      store it. To define it annotate your property with <i>@Coordinates</i> or
      <i>@Stereotype("COORDINATES")</i>:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@Coordinates @Column(length=50)
private String location;
</code></pre> </div>
    <div class="wiki" style="display: block;">Note the type, <i>String</i>, and
      the length, 50, enough to store coordinates. From the above code you get:</div>
    <img src="files/model_en003.png" alt="model_en003.png" title="model_en003.png">
    <div class="wiki" style="display: block;">The user can mark in any part of
      the map then the coordinates change. Also if he types or pastes the
      coordinates in the field the map and the mark are repositioned.</div>
    <div class="wiki" style="display: block;">You can use <i>@Coordinates</i>
      without any special setup, however you have the option of changing the
      tile provider in <i>xava.properties</i>. OpenXava uses an open source
      JavaScript library to draw the map (<a href="https://leafletjs.com/">Leaflet</a>)
      and the maps are free, from <a href="https://www.openstreetmap.org/">OpenStreetMap</a>.
      Still you need tile provider servers in order maps works, you should
      install and configure a software in a server to turn the maps into images
      to send to the JavaScript component on demand. Configure such server is
      complex and time consuming, so most time it's easier to use tile provider
      servers from third parties. OpenXava allows you to define the tile
      provider you want in <i>xava.properties</i>. By default, it's configured
      to use <a href="https://opentopomap.org/">OpenTopoMap</a> with these
      entries in <i>xava.properties</i>:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-properties"># OpenTopoMap 
mapsTileProvider=https://b.tile.opentopomap.org/{z}/{x}/{y}.png
mapsAttribution=Map data © &lt;a href="https://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors, Imagery © &lt;a href="https://opentopomap.org"&gt;OpenTopoMap&lt;/a&gt; (&lt;a href="https://creativecommons.org/licenses/by-sa/3.0/"&gt;CC-BY-SA&lt;/a&gt;)
</code></pre> </div>
    <div class="wiki" style="display: block;">OpenTopoMap is free to use even
      for commercial projects with CC-BY-SA license.</div>
    <div class="wiki" style="display: block;">You can define other tile
      providers, like <a href="https://www.mapbox.com/">MapBox</a>, in this
      way: </div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-properties"># MapBox 
# Change below YOUR_ACCESS_TOKEN by your own access token
mapsTileProvider=https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=YOUR_ACCESS_TOKEN
mapsAttribution=Map data © &lt;a href="https://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors, Imagery © &lt;a href="https://www.mapbox.com/"&gt;Mapbox&lt;/a&gt;
mapsTileSize=512
mapsZoomOffset=-1
</code></pre> </div>
    <div class="wiki" style="display: block;">MapBox is a commercial provider,
      although they offer free plans. You have to register in <a href="https://www.mapbox.com/">https://www.mapbox.com/</a>
      to get an access token. Remember to change YOUR_ACCESS_TOKEN in the URL by
      your own access token. For this provider you have to define <i>mapsTileSize</i>
      and <i>mapsZoomOffset</i> in order the maps would be displayed nicely.
      With MapBox the map looks like this:</div>
    <img src="files/model_en005.png" alt="model_en005.png" title="model_en005.png">
    <div class="wiki" style="display: block;">Apart of OpenTopoMap and MaxBox
      you can use any other tile provider, such as <a href="https://stamen.com/">Stamen</a>,
      <a href="https://www.openstreetmap.org/">OpenStreeMap</a> or <a href="https://www.thunderforest.com/">Thunderforest</a>.</div>
    <div class="wiki" style="display: block;">The editor for <i>@Coordinates</i>
      is a framed editor, that is it's inside a frame the user can collapse. You
      can use the <a href="view_en.html">layout features of OpenXava by means
        of <i>@View</i></a> to place it in the user interface the way you want,
      for example, if you want a form with all fields on left and the map on
      right, you can write a <i>@View</i> annotation like this:</div>
    <div class="wiki" style="display: block;">
      <pre><code class="language-java">@View(members=
    "city [ state; "
        + "stateCondition;"
        + "code;"
        + "name;"
        + "population;"
        + "zipCode;"
        + "county;"
        + "country;"
        + "settled;"
        + "area;"
        + "elevation;"
        + "governmentType;"
        + "mayor;"
    + "], "
    + "location")
</code></pre> </div>
    <div class="wiki" style="display: block;">Where <i>location</i> <i>@Coordinates</i>
      is a&nbsp; property. Note as we used a group (those properties between
      square brackets []) for the plain properties and place that group side by
      side (using a comma) with the <i>location</i> property. The result is:<br>
      <img src="files/model_en007.png" alt="model_en007.png" title="model_en007.png"><br>
      <h3><a name="handwritten-signature"></a>Handwritten signature <em>(new in v7.6)</em></h3>
      <i>Handwritten signature is only available with <a href="https://openxava.org/xavapro">XavaPro</a></i>
      <p>To allow the user to sign by hand and save their signature in a property,
        you have to annotate the property with <i>@HandwrittenSignature</i> or <i>@Stereotype("HANDWRITTEN_SIGNATURE")</i>:</p>
      <pre><code class="language-java">import com.openxava.annotations.*; // Not org.openxava.annotations.*

...

@HandwrittenSignature
@Column(length=32)  
private String customerSignature;</code></pre>
      <p>Note how the annotation is in the package <i>com.openxava.annotations</i> (from XavaPro) and not 
        in <i>org.openxava.annotations</i>.</p>
      <p>The property would be displayed like this:</p>
      <img src="files/model_en007bis.png" alt="model_en007bis.png" title="model_en007bis.png">
      <p>The user will be able to sign with their finger or a stylus for touch screens, especially
        designed for mobile phones and tablets, although it is also possible to sign using the mouse.</p>
      <p>The property type is a <i>String</i> of 32 characters where an id is stored,
        not the signature itself. Signatures can be stored 
        <a href="#Model-Properties-FILE%20%28new%20in%20v5.0%29//%20and%20FILES%20//%28new%20in%20v5.1%29%20stereotypes-Storage%20in%20File%20System">
          in the file system</a>
        or 
        <a href="#Model-Properties-FILE%20%28new%20in%20v5.0%29//%20and%20FILES%20//%28new%20in%20v5.1%29%20stereotypes-Storage%20in%20Database">
          in the database</a>, using the same mechanism (the same <i>filePersistorClass</i>)
         as <i>@File</i> and <i>@Files</i>. It is also possible to <a href="#manage-files-programmatically">
          manipulate signatures programmatically with <i>FilePersistorFactory</i></a> as 
          with <i>@File</i> and <i>@Files</i>.</p>

      <h3><a name="masks"></a>Mask <em>(new in v7.1)</em></h3>
      A mask in String defines the valid format of input values. To do this, you
      must use the <i>@Mask</i> annotation with some of the following
{{ ... }}
      validators:<br>
      <ul>
        <li>'L': the user must enter an alphabetical letter from A ~ z.</li>
        <li>'0': the user must enter a digit.</li>
        <li>'A': the user must enter an alphanumeric character.</li>
        <li>'#': the user must enter a digit, blank space, '+' or '-'.</li>
      </ul>
      <br>
      You can also add special characters, blank spaces statically and even
      combine validators, for example:<br>
      <pre><code class="language-java">@Mask("L-000000")
private String passport;
@Mask("0000 0000 0000 0000")
private String creditCard;
@Mask("LL 000 AA")
private String carPlate;
@Mask("0.000/0-000")
private String customMask;
</code></pre> <img src="files/model_en008.png" alt="model_en008.png" title="model_en008.png">
    </div>
    <div class="wiki" style="display: block;">
      <h3 id="toc11"><a name="Model-Properties-Concurrency and version property"></a>Concurrency
        and version property</h3>
      Concurrency is the ability of the application to allow several users to
      save data at same time without losing data. OpenXava uses the optimistic
      concurrency of JPA. When you use optimistic concurrency the records are
      not locked allowing high concurrency without losing data integrity.<br>
      For example, if a user A reads a record and then a user B reads the same
      record, modifies it and saves the changes, when the user A tries to save
      the record he receives an error, then he needs to refresh the data and to
      retry his modification.<br>
      For activating concurrency support for an entity you only need to declare
      a property using <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Version.html"

          rel="nofollow">@Version</a></em>, in this way:<br>
      <pre><code class="language-java">@Version
private Integer version;</code></pre>
      This property is persistence engine use, your application or your user
      must not use this property directly. If you don't use automatic schema
      evolution remember to add the column VERSION to the table.<br>
      <h3 id="toc12"><a name="Model-Properties-Enums"></a>Enums</h3>
      OpenXava supports Java 5 enums. An enum allows you to define a property
      that can hold one of the indicated values only .<br>
      It's easy to use, let's see this example:<br>
      <pre><code class="language-java">private Distance distance;
public enum Distance { LOCAL, NATIONAL, INTERNATIONAL };
</code></pre>
      The <em>distance</em> property only can have the following values: LOCAL,
      NATIONAL or INTERNATIONAL, and as <em>@Required</em> is not specified, no
      value (null) is allowed too. Since v5.3 if <em>@Required</em> is
      specified, the first option is the default value and an empty value is not
      available. If a different default value is required, use <em>@DefaultValueCalculator</em>.
      Since v5.6.1 the enums annotated with <em>@Required</em> in an <a class="wiki_link"

        href="#Model-References-Embedded%20reference">embeddable class</a> will
      display empty value if it is used in a collection of elements.<br>
      <br>
      At the user interface level the current implementation uses a combo. The
      label for each value is obtained from the <em>i18n</em> files.<br>
      At the database level, the value is by default saved as an integer (0 for
      LOCAL, 1 for NATIONAL, 2 for INTERNATIONAL and null for no value), but
      another field type can easily be configured in order to work correctly
      with legacy databases. See more about this in the <a class="wiki_link" href="mapping_en.html">mapping
        chapter</a>.<br>
      <h3 id="toc12"><a name="enums-with-icon"></a>Enums with icon <i>(new in
          v6.3)</i></h3>
      You can associate an icon to each enum option using <a href="https://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/model/IIconEnum.html"><i>org.openxava.model.IIconEnum</i></a>:<span

        class="sy0"></span>
      <div class="wiki" id="content_view">
        <pre><code class="language-java">public enum Priority implements IIconEnum { 
<br>	LOW("transfer-down"), MEDIUM("square-medium"), HIGH("transfer-up");

	private String icon;

	private Priority(String icon) {
		this.icon = icon;
	}

	public String getIcon() {
		return icon;
	} 
		
};
private Priority priority;
</code></pre>Just make your enum to implement <i>IIconEnum</i> that forces you
        to have a <i>getIcon()</i> method. This method has to return an icon id
        from <a href="https://pictogrammers.com/library/mdi/">Material Design Icons</a>.
        OpenXava can use these icons in several parts of the UI, for example in
        list:</div>
      <img src="files/model_en010.png" alt="">
      <h3 id="toc13"><a name="Model-Properties-Calculated properties"></a>Calculated
        properties</h3>
      The calculated properties are read only (only have <em>getter</em>) and
      are not persistent (they do not match with any column of database table).<br>
      A calculated property is defined in this way:<br>
      <pre><code class="language-java">@Depends("unitPrice") // 1
@Max(9999999999L) // 2
public BigDecimal getUnitPriceInPesetas() {
 if (unitPrice == null) return null;
 return unitPrice.multiply(new BigDecimal("166.386")).setScale(0, BigDecimal.ROUND_HALF_UP);
}
</code></pre>
      According to the above definition now you can use the code in this way:<br>
      <pre><code class="language-java">Product product = ...
product.setUnitPrice(2);
BigDecimal result = product.getUnitPriceInPesetas();
</code></pre>
      And <em>result</em> will hold 332.772.<br>
      When the property <em>unitPriceInPesetas</em> is displayed to the user
      it's not editable, and its editor has a length of 10, indicated using <em>@Max(9999999999L)</em>
      (2). Also, because of you use <em>@Depends("unitPrice")</em> (1) when the
      user will change the value of the <em>unitPrice</em> property in the user
      interface the <em>unitPriceInPesetas</em> property will be recalculated
      and its value will be refreshed to the user. <i>@Depends</i> allows you
      to define multiple properties separated by commas, and you can depend on
      both plain properties and references. See the <a href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Depends.html">JavaDoc
        of <i>@Depends</i></a> for more details.<br>
      From a calculated property you have direct access to JDBC connections,
      here is an example:<br>
      <pre><code class="language-java">@Max(999)
public int getDetailsCount() {
 // An example of using JDBC
 Connection con = null;
 try {
 con = DataSourceConnectionProvider.getByComponent("Invoice").getConnection(); // 1
 String table = MetaModel.get("InvoiceDetail").getMapping().getTable();
 PreparedStatement ps = con.prepareStatement("select count(*) from " + table +
 " where INVOICE_YEAR = ? and INVOICE_NUMBER = ?");
 ps.setInt(1, getYear());
 ps.setInt(2, getNumber());
 ResultSet rs = ps.executeQuery();
 rs.next();
 Integer result = new Integer(rs.getInt(1));
 ps.close();
 return result;
 }
 catch (Exception ex) {
 log.error("Problem calculating details count of an Invoice", ex);
 // You can throw any runtime exception here
 throw new SystemException(ex);
 }
 finally {
 try {
 con.close();
 }
 catch (Exception ex) {
 }
 }
}
</code></pre>
      Yes, the JDBC code is ugly and awkward, but sometimes it can help to solve
      performance problems. The <em>DataSourceConnectionProvider</em> class
      allows you to obtain a connection associated to the same data source that
      the indicated entity (<em>Invoice</em> in this case). This class is for
      your convenience, but you can access to a JDBC connection using JNDI or
      any other way you want. In fact, in a calculated property you can write
      any code that Java allows you.<br>
      If you are using property-based access, that means you annotate the
      getters or setters of your class, then you have to add the <em><a class="wiki_link_ext"

          href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Transient.html"

          rel="nofollow">@Transient</a></em> annotation to your calculated
      property, in this way:<br>
      <pre><code class="language-java">private long number;

@Id @Column(length=10) // You annotated the getter,
public long getNumber() { // so JPA will use property-base access for your class
 return number;
}
public void setNumber(long number) {
 this.number = number;
}

@Transient // You have to annotate as Transient your calculated property
public String getZoneOne() { // because you are using property-based access
 return "In ZONE 1";
}
</code></pre>
      <h3 id="toc14"><a name="Model-Properties-Formula (new in v3.1.4)"></a>Formula
        <em>(new in v3.1.4)</em></h3>
      Using <em><a class="wiki_link_ext" href="http://docs.jboss.org/hibernate/stable/annotations/api/org/hibernate/annotations/Formula.html"

          rel="nofollow">@Formula</a></em> from <a class="wiki_link_ext" href="http://annotations.hibernate.org/"

        rel="nofollow">Hibernate Annotations</a> you can define a calculation
      for your property. This calculation is expressed using SQL, and it is
      executed by the database, not by Java. You only need to write a valid SQL
      fragment:<br>
      <pre><code class="language-java">@org.hibernate.annotations.Formula("UNITPRICE * 1.16")
private BigDecimal unitPriceWithTax;
public BigDecimal getUnitPriceWithTax() {
 return unitPriceWithTax;
}</code></pre>
      The use is simple. Put your calculation exactly in the same way that you
      would put it in a SQL statement.<br>
      Usually the properties with <em>@Formula</em> are read only properties,
      that is, they have only getter, not setter. When the object is read from
      database the calculation is done by the database and the property is
      populate with it.<br>
      This is an alternative to calculated properties. It has the advantage that
      the user can filter by this property in list mode, and the disadvantage
      that you have to use SQL instead of Java, and you cannot use <em><a class="wiki_link_ext"

          href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Depends.html"

          rel="nofollow">@Depends</a></em> for live recalculation of the value.<br>
      <h3 id="toc15"><a name="Model-Properties-Default value calculator"></a>Default
        value calculator</h3>
      With <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/DefaultValueCalculator.html"

          rel="nofollow">@DefaultValueCalculator</a></em> you can associate
      logic to a property, in this case the property is readable and writable.
      This calculator is for calculating its initial value. For example:<br>
      <pre><code class="language-java">@DefaultValueCalculator(CurrentYearCalculator.class)
private int year;
</code></pre>
      In this case when the user tries to create a new Invoice (for example) he
      will find that the year field already has a value, that he can change it
      if he wants to. The logic for generating this value is in the <em>CurrentYearCalculator</em>
      class, that it's:<br>
      <pre><code class="language-java">package org.openxava.calculators;

import java.util.*;

/**
 * @author Javier Paniza
 */
public class CurrentYearCalculator implements ICalculator {

 public Object calculate() throws Exception {
 Calendar cal = Calendar.getInstance();
 cal.setTime(new java.util.Date());
 return new Integer(cal.get(Calendar.YEAR));
 }

}
</code></pre>
      It's possible to customize the behaviour of a calculator setting the value
      of its properties, as following:<br>
      <pre><code class="language-java">@DefaultValueCalculator(
 value=org.openxava.calculators.StringCalculator.class,
 properties={ @PropertyValue(name="string", value="GOOD") }
)
private String relationWithSeller;</code></pre>
      In this case for calculating the default value OpenXava instances <em>StringCalculator</em>
      and then injects the value "GOOD" in the property <em>string</em> of <em>StringCalculator</em>,
      and finally it calls to the <em>calculate()</em> method in order to
      obtain the default value for <em>relationWithSeller</em>. As you see, the
      use of <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValue.html"

          rel="nofollow">@PropertyValue</a></em> annotation allows you to create
      reusable calculators.<br>
      <em>@PropertyValue</em> allows to inject the value from other displayed
      properties, in this way:<br>
      <pre><code class="language-java">@DefaultValueCalculator(
 value=org.openxava.test.calculators.CarrierRemarksCalculator.class,
 properties={
 @PropertyValue(name="drivingLicenceType", from="drivingLicence.type")
 }
)
private String remarks;</code></pre>
      In this case before to execute the calculator OpenXava fills the <em>drivingLicenceType</em>
      property of <em>CarrierRemarksCalculator</em> with the value of the
      displayed property <em>type</em> from the reference <em>drivingLicence</em>.
      As you see the <em>from</em> attribute supports qualified properties
      (reference.property). Moreover, each time that <em>drivingLicence.type</em>
      changes <em>remarks</em> is recalculated (<em>new in v5.1</em>, with
      previous versions it was recalculated only the first time).<br>
      Also you can use <em>@PropertyValue</em> without <em>from</em> nor <em>value</em>:<br>
      <pre><code class="language-java">@DefaultValueCalculator(value=DefaultProductPriceCalculator.class, properties=
 @PropertyValue(name="familyNumber")
)</code></pre>
      In this case OpenXava takes the value of the displayed property <em>familyNumber</em>
      and inject it in the property <em>familyNumber</em> of the calculator;
      that is <em>@PropertyValue(name="familiyNumber")</em> is equivalent to <em>@PropertyValue(name="familiyNumber",
        from="familyNumber")</em>.<br>
      From a calculator you have direct access to JDBC connections, here is an
      example:<br>
      <pre><code class="language-java">@DefaultValueCalculator(value=DetailsCountCalculator.class,
 properties= {
 @PropertyValue(name="year"),
 @PropertyValue(name="number"),
 }
)
private int detailsCount;
</code></pre>
      And the calculator class:<br>
      <pre><code class="language-java">package org.openxava.test.calculators;

import java.sql.*;

import org.openxava.calculators.*;
import org.openxava.util.*;

/**
 * @author Javier Paniza
 */
public class DetailsCountCalculator implements IJDBCCalculator { // 1

 private IConnectionProvider provider;
 private int year;
 private int number;

 public void setConnectionProvider(IConnectionProvider provider) { // 2
 this.provider = provider;
 }

 public Object calculate() throws Exception {
 Connection con = provider.getConnection();
 try {
 PreparedStatement ps = con.prepareStatement(
 "select count(*) from XAVATEST.INVOICEDETAIL " +
 "where INVOICE_YEAR = ? and INVOICE_NUMBER = ?");
 ps.setInt(1, getYear());
 ps.setInt(2, getNumber());
 ResultSet rs = ps.executeQuery();
 rs.next();
 Integer result = new Integer(rs.getInt(1));
 ps.close();
 return result;
 }
 finally {
 con.close();
 }
 }

 public int getYear() {
 return year;
 }

 public int getNumber() {
 return number;
 }

 public void setYear(int year) {
 this.year = year;
 }

 public void setNumber(int number) {
 this.number = number;
 }

}</code></pre>
      To use JDBC your calculator must implement <em>IJDBCCalculator</em> (1)
      and then it will receive an <em>IConnectionProvider</em> (2) that you can
      use within the <em>calculate()</em> method.<br>
      OpenXava comes with a set of predefined calculators, you can find them in
      <em>org.openxava.calculators</em>.<br>
      <h3 id="toc16"><a name="Model-Properties-Default values on create"></a>Default
        values on create</h3>
      You can indicate that the value will be calculated just before creating
      (inserting into database) an object for the first time.<br>
      Usually for the key case you use the JPA standard. For example, if you
      want to use an <em>identity</em> (auto increment) column as key:<br>
      <pre><code class="language-java">@Id @Hidden
@GeneratedValue(strategy=GenerationType.IDENTITY)
private Integer id;
</code></pre>
      You can use other generation techniques, for example, a database <em>sequence</em>
      can be defined in this JPA standard way:<br>
      <pre><code class="language-java">@SequenceGenerator(name="SIZE_SEQ", sequenceName="SIZE_ID_SEQ", allocationSize=1 )
@Hidden @Id @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="SIZE_SEQ")
private Integer id;
</code></pre>
      If you want to generate a unique identifier of type String and 32
      characters, you can use a Hibernate extesion of JPA:<br>
      <pre><code class="language-java">@Id @GeneratedValue(generator="system-uuid") @Hidden
@GenericGenerator(name="system-uuid", strategy = "uuid")
private String oid;
</code></pre>
      Look at section 9.1.9 of JPA 1.0 specification (part of JSR-220) for
      learning more about <em>@GeneratedValues</em>.<br>
      If you want to use your own logic for generating the value on creating, or
      you want a generated new value for a non-key property then you cannot use
      the JPA <em>@GeneratedValue</em>, although it's easy to solve these cases
      using JPA. You only need to add this code to your class:<br>
      <pre><code class="language-java">@PrePersist
private void calculateCounter() {
 counter = new Long(System.currentTimeMillis()).intValue();
}
</code></pre>
      The JPA <em>@PrePersist</em> annotation does that this method will be
      executed before inserting the data the first time in database, in this
      method you can calculate the value for your key or non-key properties with
      your own logic.<br>
      <h3 id="toc17"><a name="Model-Properties-Property validator"></a>Property
        validator</h3>
      A <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValidator.html"

          rel="nofollow">@PropertyValidator</a></em> executes validation logic
      on the value assigned to the property just before storing. A property may
      have several validators:<br>
      <div class="wiki" id="content_view">
        <pre><code class="language-java">@PropertyValidator(value=ExcludeStringValidator.class, properties=
    @PropertyValue(name="string", value="MOTO")
)
@PropertyValidator(value=ExcludeStringValidator.class, properties=
    @PropertyValue(name="string", value="COCHE")
)
private String remarks;
</code></pre>
        With an OpenXava older than 6.1 you have to wrap the <i>@PropertyValidator</i>
        annotations with <i>@PropertyValidators</i>:</div>
      <pre><code class="language-java">@PropertyValidators ({ // Only needed until v6.0.2
   @PropertyValidator(value=ExcludeStringValidator.class, properties=
       @PropertyValue(name="string", value="MOTO")
   ),
   @PropertyValidator(value=ExcludeStringValidator.class, properties=
       @PropertyValue(name="string", value="COCHE")
   )
})
private String remarks;
</code></pre> The technique to configure the validator (with <em><a class="wiki_link_ext"

          href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValue.html"

          rel="nofollow">@PropertyValue</a></em>, though <em>from</em>
      attribute does not work, you must use <em>value</em> always) is exactly
      the same than in <a class="wiki_link" href="#Model-Properties-Default%20value%20calculator">calculators</a>.
      With the attribute <em>onlyOnCreate=”true”</em> you can define that the
      validation will be executed only when the object is created, and not when
      it is modified.<br>
      The validator code is:<br>
      <pre><code class="language-java">package org.openxava.test.validators;

import org.openxava.util.*;
import org.openxava.validators.*;

/**
 * @author Javier Paniza
 */

public class ExcludeStringValidator implements IPropertyValidator { // 1

 private String string;

 public void validate(
 Messages errors, // 2
 Object value, // 3
 String objectName, // 4
 String propertyName) // 5
 throws Exception {
 if (value==null) return;
 if (value.toString().indexOf(getString()) >= 0) {
 errors.add("exclude_string", propertyName, objectName, getString());
 }
 }

 public String getString() {
 return string==null?"":string;
 }

 public void setString(String string) {
 this.string = string;
 }

}</code></pre>
      A validator has to implement <em>IPropertyValidator</em> (1), this
      obliges the calculator to have a <em>validate()</em> method where the
      validation of property is executed. The arguments of <em>validate()</em>
      method are:<br>
      <ol>
        <li><strong>Messages errors</strong>: An object of type <em>Messages</em>
          that represents a set of messages (like a smart collection) and where
          you can add the validation errors that you find.</li>
        <li><strong>Object value</strong>: The value to validate.</li>
        <li><strong>String objectName</strong>: Object name of the container of
          the property to validate. Useful to use in error messages.</li>
        <li><strong>String propertyName</strong>: Name of the property to
          validate. Useful to use in error messages.</li>
      </ol>
      As you can see when you find a validation error you have to add it (with <em>errors.add()</em>)
      by sending a message identifier and the arguments. If you want to obtain a
      significant message you need to add to your <em>i18n</em> file the next
      entry:<br>
      <pre><code class="language-properties">exclude_string={0} cannot contain {2} in {1}</code></pre>
      If the identifier sent is not found in the resource file, this identifier
      is shown as is; but the recommended way is always to use identifiers of
      resource files.<br>
      The validation is successful if no messages are added and fails if
      messages are added. OpenXava collects all messages of all validators
      before saving and if there are messages, then it displays them and does
      not save the object.<br>
      Since v4.6.1 is also possible to use in the validator the message of <em>@PropertyValidator</em>.
      That is, you can write:<br>
      <pre><code class="language-java">@PropertyValidator(value=BookTitleValidator.class, message="{rpg_book_not_allowed}")
private String title;</code></pre>
      If the message is between braces is get from i18n files, if not is used as
      is.<br>
      Moreover, you have to implement the <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/validators/IWithMessage.html"

          rel="nofollow">IWithMessage</a></em> interface in your validator:<br>
      <pre><code class="language-java">public class BookTitleValidator implements IPropertyValidator, IWithMessage {

    private String message;

    public void setMessage(String message) throws Exception {
        this.message = message; // This message is from @PropertyValidator
    }

    public void validate(Messages errors, Object value, String propertyName, String modelName) {
       if (((String)value).contains("RPG")) {
           errors.add(message); // You can add it directly
       }
    }

}</code></pre>
      The message specified in the <em>@PropertyValidator</em> annotation, <em>rpg_book_not_allowed</em>,
      is injected in the validator calling <em>setMessage()</em>. This message
      can be added directly as an error.<br>
      The package <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/validators/package-summary.html"

          rel="nofollow">org.openxava.validators</a></em> contains some common
      validators.<br>
      <em>@PropertyValidator</em> is defined as a <a class="wiki_link" href="model_en.html#Model-Bean%20Validation">Bean
        Validation</a> constraint since v5.3 and as a <a class="wiki_link" href="model_en.html#Model-Hibernate%20Validator%20%28new%20in%20v3.0.1%29">Hibernate
        Validator</a> constraint until v5.2.x.<br>
      If you need to use JPA in your validator, please see <a class="wiki_link"

        href="#Model-JPA%20callback%20methods">Using JPA from a Validator or
        Callback</a>.<br>
      <h3 id="toc18"><a name="Model-Properties-Default validator (new in v2.0.3)"></a>Default
        validator <em>(new in v2.0.3)</em></h3>
      You can define a default validator for properties depending on its type or
      stereotype. In order to do it you have to use the file <em>validators.xml</em>
      in <i>src/main/resources/xava</i> (just <em>xava</em> before v7) of your
      project to define in it the default validators.<br>
      For example, you can define in your <em>validators.xml</em> the
      following:<br>
      <pre><code class="language-xml">&lt;validators&gt;
 &lt;default-validator&gt;
 &lt;validator-class
 class="org.openxava.test.validators.PersonNameValidator"/&gt;
 &lt;for-stereotype stereotype="PERSON_NAME"/&gt;
 &lt;/default-validator&gt;
&lt;/validators&gt;</code></pre>
      In this case you are associating the validator <em>PersonNameValidator</em>
      to the stereotype PERSON_NAME. Now if you define a property as the next
      one:<br>
      <pre><code class="language-java">@Required @Stereotype("PERSON_NAME")
private String name;</code></pre>
      This property will be validated using <em>PersonNameValidator</em>
      although the property itself does not define any validator. <em>PersonNameValidator</em>
      is applied to all properties with PERSON_NAME stereotype.<br>
      You can also assign a default validator to a type.<br>
      In <em>validators.xml</em> files you can also define the validators for
      determine if a required value is present (executed when you use <em>@Required</em>).
      Moreover you can assign names (alias) to validator classes.<br>
      You can learn more about validators examining <a href="https://github.com/openxava/openxava/blob/master/openxava/src/main/resources/xava/default-validators.xml"><em>openxava/src/main/resources/xava/default-validators.xml</em></a>
      and <a href="https://github.com/openxava/openxava/blob/master/openxavatest/src/main/resources/xava/validators.xml"><em>openxavatest/src/main/resources/xava/validators.xml</em></a>.<br>
      Default validators do not apply when you use directly the JPA api for
      saving your entities.<br>
      <h3 id="toc19"><a name="Model-Properties-Calculation (new in v5.7)"></a>Calculation
        <em>(new in v5.7)</em></h3>
      With <em>@Calculation</em> you can define an arithmetic expression to do
      the calculation for the property. The expression can contain +, -, *, /,
      (), numeric values and properties names of the same entity. For example:<br>
      <pre><code class="language-java">@Calculation("((hours * worker.hourPrice) + tripCost - discount) * vatPercentage / 100")
private BigDecimal total;</code></pre>
      Note as <em>worker.hourPrice</em> is used to get the value from the
      reference.<br>
      The calculation is executed and displayed when the user changes any value
      of the properties used in the expression in the user interface, however
      the value is not saved until the user clicks on save button. All the
      properties used in <i>@Calculation</i> (the operands) must be displayed
      in the user interface in order <i>@Calculation</i> works, if it is not
      the case you should use a regular calculated property instead.<br>
      <h2 id="toc20"><a name="Model-References"></a>References</h2>
      A reference allows access from an entity to another entity. A reference is
      translated to Java code as a property (with its <em>getter</em> and its <em>setter</em>)
      whose type is the referenced model Java type. For example a <em>Customer</em>
      can have a reference to his <em>Seller</em>, and that allows you to write
      code like this:<br>
      <pre><code class="language-java">Customer customer = ...
customer.getSeller().getName();</code></pre>
      to access to the name of the seller of that customer.<br>
      The syntax of reference is:<br>
      <pre><code class="language-java">@Required // 1
@Id // 2
@SearchKey // 3 New in v3.0.2
@DefaultValueCalculator // 4
@ManyToOne( // 5
 optional=false // 1
)
private type referenceName; // 5
public type getReferenceName() { ... } // 5
public void setReferenceName(type newValue) { ... } // 5</code></pre>
      <ol>
        <li><strong>@ManyToOne(optional=false)</strong> (<a class="wiki_link_ext"

            href="http://java.sun.com/javaee/5/docs/api/javax/persistence/ManyToOne.html"

            rel="nofollow">JPA</a>), <strong>@Required</strong> (<a class="wiki_link_ext"

            href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Required.html"

            rel="nofollow">OX</a>) (optional, the JPA is the preferred one):
          Indicates if the reference is required. When saving OpenXava verifies
          if the required references are present, if not the saving is aborted
          and a list of validation errors is returned.</li>
        <li><strong>@Id</strong> (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Id.html"

            rel="nofollow">JPA</a>, optional): Indicates if the reference is
          part of the key. The combination of key properties and reference
          properties should map to a group of database columns with unique
          values, typically the primary key.</li>
        <li><strong>@SearchKey</strong> (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/SearchKey.html"

            rel="nofollow">OX</a>, optional): <em>(New in v3.0.2)</em> The
          search key references are used by the user as key for searching
          objects. They are editable in user interface of references allowing to
          the user to type its value for searching. OpenXava uses the <em>@Id</em>
          members for searching by default, and if the id members are hidden
          then it uses the first property in the view. With <em>@SearchKey</em>
          you can choose explicitly references for searching.</li>
        <li><strong><a class="wiki_link" href="#Model-Properties-Default%20value%20calculator">@DefaultValueCalculator</a></strong>
          (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/DefaultValueCalculator.html"

            rel="nofollow">OX</a>, one, optional): Implements the logic for
          calculating the initial value of the reference. This calculator must
          return the key value, that can be a simple value (only if the key of
          referenced object is simple) or key object (a special object that
          wraps the key).</li>
        <li><strong>Reference declaration</strong>: A regular Java reference
          declaration with its getters and setters. The reference is marked with
          <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/ManyToOne.html"

              rel="nofollow">@ManyToOne (JPA)</a></em> and the type must be
          another entity.</li>
      </ol>
      A little example of references:<br>
      <pre><code class="language-java">@ManyToOne
private Seller seller; // 1
public Seller getSeller() {
 return seller;
}
public void setSeller(Seller seller) {
 this.seller = seller;
}

@ManyToOne(fetch=FetchType.LAZY)
private Seller alternateSeller; // 2
public Seller getAlternateSeller() {
 return alternateSeller;
}
public void setAlternateSeller(Seller alternateSeller) {
 this.alternateSeller = alternateSeller;
}

</code></pre>
      <ol>
        <li>A reference called <em>seller</em> to the entity of <em>Seller</em>
          entity.</li>
        <li>A reference called <em>alternateSeller</em> to the entity <em>Seller</em>.
          In this case we use <em>fetch=FetchType.LAZY</em>, in this way the
          data is read from database on demand. This is the most efficient
          approach, but it's not the JPA default, therefore it's advisable to <strong>use
            always <em>fetch=FetchType.LAZY</em></strong> when declaring the
          references.</li>
      </ol>
      If you assume that this is in an entity named <em>Customer</em>, you
      could write:<br>
      <pre><code class="language-java">Customer customer = ...
Seller seller = customer.getSeller();
Seller alternateSeller = customer.getAlternateSeller();
</code></pre>
      <h3 id="toc21"><a name="Model-References-Default value calculator in references"></a>Default
        value calculator in references</h3>
      In a reference <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/DefaultValueCalculator.html"

          rel="nofollow">@DefaultValueCalculator</a></em> works <a class="wiki_link"

        href="#Model-Properties-Default%20value%20calculator">like in a property</a>,
      only that it has to return the value of the reference key.<br>
      For example, in the case of a reference with simple key, you can write:<br>
      <pre><code class="language-java">@ManyToOne(optional=false, fetch=FetchType.LAZY) @JoinColumn(name="FAMILY")
@DefaultValueCalculator(value=IntegerCalculator.class, properties=
 @PropertyValue(name="value", value="2")
)
private Family family;
</code></pre>
      The <em>calculate()</em> method is:<br>
      <pre><code class="language-java">public Object calculate() throws Exception {
 return new Integer(value);
}
</code></pre>
      As you can see an integer is returned, that is, the default value for
      family is 2.<br>
      In the case of composite key:<br>
      <pre><code class="language-java">@ManyToOne(fetch=FetchType.LAZY)
@JoinColumns({
 @JoinColumn(name="ZONE", referencedColumnName="ZONE"),
 @JoinColumn(name="WAREHOUSE", referencedColumnName="NUMBER")
})
@DefaultValueCalculator(DefaultWarehouseCalculator.class)
private Warehouse warehouse;
</code></pre>
      And the calculator code:<br>
      <pre><code class="language-java">package org.openxava.test.calculators;

import org.openxava.calculators.*;

/**
 * @author Javier Paniza
 */
public class DefaultWarehouseCalculator implements ICalculator {

  public Object calculate() throws Exception {
    Warehouse key = new Warehouse();
    key.setNumber(4);
    key.setZoneNumber(4);
    return key;
  }

}
</code></pre>
      Returns an object of type <em>Warehouse</em> but filling only the key
      properties.<br>
      <h3 id="toc22"><a name="Model-References-Using references as key"></a>Using
        references as key</h3>
      You can use references as key, or as part of the key. You have to declare
      the reference as <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Id.html"

          rel="nofollow">@Id</a></em>, and use an id class, as following:<br>
      <pre class="java5">@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
@IdClass<span class="br0">(</span>AdditionalDetailKey.<span class="kw2">class</span><span

class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> AdditionalDetail <span

class="br0">{</span>
&nbsp;
 <span class="co1">// JoinColumn is also specified in AditionalDetailKey because</span>
 <span class="co1">// a bug in Hibernate, see http://opensource.atlassian.com/projects/hibernate/browse/ANN-361</span>
 @Id @ManyToOne<span class="br0">(</span>fetch=FetchType.<span class="me1">LAZY</span><span

class="br0">)</span>
 @JoinColumn<span class="br0">(</span>name=<span class="st0">"SERVICE"</span><span

class="br0">)</span>
 <span class="kw2">private</span> Service service<span class="sy0">;</span>
&nbsp;
 @Id @Hidden
 <span class="kw2">private</span> <span class="kw3">int</span> counter<span class="sy0">;</span>
&nbsp;
 ...
&nbsp;
<span class="br0">}</span></pre>
      Also, you need to write your key class:<br>
      <pre class="java5"><span class="kw2">public</span> <span class="kw2">class</span> AdditionalDetailKey <span

class="kw2">implements</span> java.<span class="me1">io</span>.<a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/io/Serializable.html"><span

class="kw20">Serializable</span></a> <span class="br0">{</span>
&nbsp;
 @ManyToOne<span class="br0">(</span>fetch=FetchType.<span class="me1">LAZY</span><span

class="br0">)</span>
 @JoinColumn<span class="br0">(</span>name=<span class="st0">"SERVICE"</span><span

class="br0">)</span>
 <span class="kw2">private</span> Service service<span class="sy0">;</span>
&nbsp;
 @Hidden
 <span class="kw2">private</span> <span class="kw3">int</span> counter<span class="sy0">;</span>
&nbsp;
 <span class="co1">// equals, hashCode, toString, getters and setters</span>
 ...
&nbsp;
 <span class="br0">}</span></pre>
      You need to write the key class although the key would be only a reference
      with only a join column.<br>
      It's better to use this feature only when you are working against legacy
      databases, if you have control over the schema use an autogenerated id
      instead.<br>
      <h3 id="toc23"><a name="Model-References-Embedded reference"></a>Embedded
        reference</h3>
      You can reference an <a class="wiki_link" href="#Model-Embeddable%20classes">embeddable
        class</a> using the <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Embedded.html"

          rel="nofollow">@Embedded</a></em> annotation. For example, in your
      entity you can write:<br>
      <pre class="java5">@Embedded
<span class="kw2">private</span> Address address<span class="sy0">;</span>
&nbsp;</pre>
      And you have to define the <em>Address</em> class as embeddable:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@Embeddable
<span class="kw2">public</span> <span class="kw2">class</span> Address <span class="kw2">implements</span> IWithCity <span

class="br0">{</span> <span class="co1">// 1</span>
&nbsp;
 @Required @Column<span class="br0">(</span>length=<span class="nu0">30</span><span

class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> street<span class="sy0">;</span>
&nbsp;
 @Required @Column<span class="br0">(</span>length=<span class="nu0">5</span><span

class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">int</span> zipCode<span class="sy0">;</span>
&nbsp;
 @Required @Column<span class="br0">(</span>length=<span class="nu0">20</span><span

class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> city<span class="sy0">;</span>
&nbsp;
 <span class="co1">// ManyToOne inside an Embeddable is not supported by JPA 1.0 (see at 9.1.34),</span>
 <span class="co1">// but Hibernate implementation supports it.</span>
 @ManyToOne<span class="br0">(</span>fetch=FetchType.<span class="me1">LAZY</span>, optional=<span

class="kw4">false</span><span class="br0">)</span> @JoinColumn<span class="br0">(</span>name=<span

class="st0">"STATE"</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/org/omg/PortableServer/POAManagerPackage/State.html"><span

class="kw154">State</span></a> state<span class="sy0">;</span> <span class="co1">// 2</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getCity<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> city<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setCity<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> city<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">city</span> = city<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getStreet<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> street<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setStreet<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> street<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">street</span> = street<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getZipCode<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> zipCode<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setZipCode<span class="br0">(</span><span

class="kw3">int</span> zipCode<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">zipCode</span> = zipCode<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/org/omg/PortableServer/POAManagerPackage/State.html"><span

class="kw154">State</span></a> getState<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> state<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setState<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/org/omg/PortableServer/POAManagerPackage/State.html"><span

class="kw154">State</span></a> state<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">state</span> = state<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre>
      As you see an embeddable class can implement an interface (1) and contain
      references (2), among other things, but it can't use JPA callbacks
      methods.<br>
      This code can be used this way, for reading:<br>
      <pre class="java5">Customer customer = ...
<span class="me1">Address</span> address = customer.<span class="me1">getAddress</span><span

class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
address.<span class="me1">getStreet</span><span class="br0">(</span><span class="br0">)</span><span

class="sy0">;</span> <span class="co1">// to obtain the value</span></pre>
      Or in this other way to set a new address:<br>
      <pre class="java5"><span class="co1">// to set a new address</span>
Address address = <span class="kw2">new</span> Address<span class="br0">(</span><span

class="br0">)</span><span class="sy0">;</span>
address.<span class="me1">setStreet</span><span class="br0">(</span>“My street”<span

class="br0">)</span><span class="sy0">;</span>
address.<span class="me1">setZipCode</span><span class="br0">(</span><span class="nu0">46001</span><span

class="br0">)</span><span class="sy0">;</span>
address.<span class="me1">setCity</span><span class="br0">(</span>“Valencia”<span

class="br0">)</span><span class="sy0">;</span>
address.<span class="me1">setState</span><span class="br0">(</span>state<span class="br0">)</span><span

class="sy0">;</span>
customer.<span class="me1">setAddress</span><span class="br0">(</span>address<span

class="br0">)</span><span class="sy0">;</span></pre>
      In this case you have a simple reference (not collection), and the
      generated code is a simple JavaBean, which life cycle is associated to its
      container object, that is, the <em>Address</em> is removed and created
      through the <em>Customer</em>. An <em>Address</em> never will have its
      own life and cannot be shared by other <em>Customer</em>.<br>
      <h2 id="toc24"><a name="Model-Collections"></a>Collections</h2>
      <h3 id="toc25"><a name="Model-Collections-Entity collections"></a>Entity
        collections</h3>
      You can define a collection of references to entities. A collection is a
      Java property of type <em>java.util.Collection</em>.<br>
      Here syntax for collection:<br>
      <pre class="java5">@Size <span class="co1">// 1</span>
@<a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/concurrent/locks/Condition.html"><span

class="kw49">Condition</span></a> <span class="co1">// 2</span>
@OrderBy <span class="co1">// 3</span>
@XOrderBy <span class="co1">// 4</span>
@OrderColumn <span class="co1">// 5  New in v5.3</span>
@OneToMany/@ManyToMany <span class="co1">// 6</span>
<span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>YourEntity<span class="sy0">&gt;</span> collectionName<span

class="sy0">;</span> <span class="co1">// 5</span>
<span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>YourEntity<span class="sy0">&gt;</span> getCollectionName<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> ... <span

class="br0">}</span> <span class="co1">// 5</span>
<span class="kw2">public</span> <span class="kw3">void</span> setCollectionName<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>YourEntity<span class="sy0">&gt;</span> newValue<span

class="br0">)</span> <span class="br0">{</span> ... <span class="br0">}</span> <span

class="co1">// 5</span>
&nbsp;</pre>
      <ol>
        <li><strong>@Size</strong> (<a class="wiki_link_ext" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/javax/validation/constraints/Size.html"

            rel="nofollow">BV</a>, <a class="wiki_link_ext" href="http://www.hibernate.org/hib_docs/validator/api/org/hibernate/validator/Size.html"

            rel="nofollow">HV</a>, optional): Minimum (<em>min</em>) and/or
          maximum (<em>max</em>) number of expected elements. This is validated
          just before saving.</li>
        <li><strong>@Condition</strong> (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Condition.html"

            rel="nofollow">OX</a>, optional): Restricts the elements that appear
          in the collection. Doesn't work with <i>@ManyToMany</i>.</li>
        <li><strong>@OrderBy</strong> (<a class="wiki_link_ext" href="http://docs.oracle.com/javaee/7/api/javax/persistence/OrderBy.html"

            rel="nofollow">JPA</a>, optional): The elements in collections will
          be in the indicated order.</li>
        <li><strong>@XOrderBy</strong> (<a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/XOrderBy.html"

            rel="nofollow">OX</a>, optional): The <em>@OrderBy</em> of JPA does
          not allow to use qualified properties (properties of references). <em>@XOrderBy</em>
          does allow it.</li>
        <li><strong><a class="wiki_link" href="model_en.html#Model-Collections-Lists%20with%20@OrderColumn%20%28new%20in%20v5.3%29">@OrderColumn</a></strong>
          (<a class="wiki_link_ext" href="http://docs.oracle.com/javaee/7/api/javax/persistence/OrderColumn.html"

            rel="nofollow">JPA</a>, optional): <em>(New in v5.3)</em> The order
          of the elements in the collection is persisted in database. A special
          column is created in the table to keep this order. The collection must
          be a <em>java.util.List</em>. The user interface allows the user to
          reorder the collection elements.</li>
        <li><strong>Collection declaration</strong>: A regular Java collection
          declaration with its getters and setters. The collection is marked
          with <em><a class="wiki_link_ext" href="http://docs.oracle.com/javaee/7/api/javax/persistence/OneToMany.html"

              rel="nofollow">@OneToMany (JPA)</a></em> or <em><a class="wiki_link_ext"

              href="http://docs.oracle.com/javaee/7/api/javax/persistence/ManyToMany.html"

              rel="nofollow">@ManyToMany (JPA)</a></em> and the type must be
          another entity.</li>
      </ol>
      Let's have a look at some examples. First a simple one:<br>
      <pre class="java5">@OneToMany <span class="br0">(</span>mappedBy=<span class="st0">"invoice"</span><span

class="br0">)</span>
<span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>Delivery<span class="sy0">&gt;</span> deliveries<span

class="sy0">;</span>
<span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>Delivery<span class="sy0">&gt;</span> getDeliveries<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> deliveries<span class="sy0">;</span>
<span class="br0">}</span>
<span class="kw2">public</span> <span class="kw3">void</span> setDeliveries<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>Delivery<span class="sy0">&gt;</span> deliveries<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">deliveries</span> = deliveries<span

class="sy0">;</span>
<span class="br0">}</span></pre>
      If you have this within an <em>Invoice</em>, then you are defining a <em>deliveries</em>
      collection associated to that <em>Invoice</em>. The details to make the
      relationship are defined in the <a class="wiki_link" href="mapping_en.html">object/relational
        mapping</a>.You use <em>mappedBy="invoice"</em> to indicate that the
      reference <em>invoice</em> of <em>Delivery</em> is used to mapping this
      collection.<br>
      Now you can write a code like this:<br>
      <pre class="java5">Invoice invoice = ...
<span class="kw1">for</span> <span class="br0">(</span>Delivery delivery: invoice.<span

class="me1">getDeliveries</span><span class="br0">(</span><span class="br0">)</span><span

class="br0">)</span> <span class="br0">{</span>
 delivery.<span class="me1">doSomething</span><span class="br0">(</span><span class="br0">)</span><span

class="sy0">;</span>
<span class="br0">}</span></pre>
      To do something with all deliveries associated to an invoice.</div>
    <div class="wiki" style="display: block;"><br>
    </div>
    <div class="wiki" style="display: block;"> The references in collections are
      bidirectional, this means that if in a <em>Seller</em> you have a <em>customers</em>
      collection, then in <em>Customer</em> you must have a reference to <em>Seller</em>.
      But it's possible that in <em>Customer</em> you have more than one
      reference to <em>Seller</em> (for example, <em>seller</em> and <em>alternateSeller</em>)
      JPA does not know which one to choose, because of this you have the
      attribute <em>mappedBy</em> of <em>@OneToMany</em>. You can use it in
      this way:<br>
      <div class="wiki">
        <pre class="java5">@OneToMany<span class="br0">(</span>mappedBy=<span class="st0">"seller"</span><span

class="br0">)</span>
<span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>Customer<span class="sy0">&gt;</span> customers<span

class="sy0">;</span></pre>
        To indicate that the reference <em>seller</em> and not <em>alternateSeller</em>
        will be used in this collection.<br>
      </div>
    </div>
    <div class="wiki" style="display: block;"><br>
    </div>
    <div class="wiki" style="display: block;">Let's look at another example a
      little more complex, in <em>Invoice</em>:<br>
      <pre class="java5">@OneToMany <span class="br0">(</span>mappedBy=<span class="st0">"invoice"</span>, cascade=CascadeType.<span

class="me1">REMOVE</span><span class="br0">)</span> <span class="co1">// 1</span>
@OrderBy<span class="br0">(</span><span class="st0">"serviceType desc"</span><span

class="br0">)</span> <span class="co1">// 2</span>
@org.<span class="me1">hibernate</span>.<span class="me1">validator</span>.<span

class="me1">Size</span><span class="br0">(</span>min=<span class="nu0">1</span><span

class="br0">)</span> <span class="co1">// 3</span>
<span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>InvoiceDetail<span

class="sy0">&gt;</span> details<span class="sy0">;</span></pre>
      <ol>
        <li>Using REMOVE as cascade type produces that when the user removes an
          invoice its details are also removed.</li>
        <li>With <em>@OrderBy</em> you force that the details will be returned
          ordered by <em>serviceType</em>.</li>
        <li>The restriction <em>@Size(min=1)</em> requires at least one detail
          for the invoice to be valid.</li>
      </ol>
      <ol>
      </ol>
      <br>
      <h3 id="collections-with-condition">Collections with condition</h3>
      You have full freedom to define how the collection data is obtained, with
      <em>@Condition</em> you can overwrite the default condition:<br>
      <pre class="java5">@<a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/concurrent/locks/Condition.html"><span

class="kw49">Condition</span></a><span class="br0">(</span>
 <span class="st0">"${warehouse.zoneNumber} = ${this.warehouse.zoneNumber} AND "</span> +
 <span class="st0">"${warehouse.number} = ${this.warehouse.number} AND "</span> +
 <span class="st0">"NOT (${number} = ${this.number})"</span>
<span class="br0">)</span>
<span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>Carrier<span class="sy0">&gt;</span> getFellowCarriers<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> <span class="kw4">null</span><span class="sy0">;</span>
<span class="br0">}</span>
&nbsp;</pre>
      If you have this collection within <em>Carrier</em>, you can obtain with
      this collection all the carriers of the same warehouse but not himself,
      that is the list of his fellow workers. As you see you can use <em>this</em>
      in the condition in order to refer to the value of a property of the
      current object. <em>@Condition</em> only applied to the user interface
      generated by OpenXava, if you call directly to <em>getFellowCarriers()</em>
      it will return null. The condition is absolute, meaning that if you set <i>@Condition("1
        = 1")</i>, it would display all the carriers in the database.</div>
    <div class="wiki" style="display: block;">
      <h3 id="calculated-collections">Calculated collections</h3>
    </div>
    <div class="wiki" style="display: block;"> If with <i>@Condition</i> you
      don't have enough, you can write the logic that returns the collection.
      The example of the previous section can be written in the following way
      too:<br>
      <pre class="java5"><span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>Carrier<span class="sy0">&gt;</span> getFellowCarriers<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
 <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/javax/management/Query.html"><span

class="kw67">Query</span></a> query = XPersistence.<span class="me1">getManager</span><span

class="br0">(</span><span class="br0">)</span>.<span class="me1">createQuery</span><span

class="br0">(</span><span class="st0">"from Carrier c where "</span> +
 <span class="st0">"c.warehouse.zoneNumber = :zone AND "</span> +
 <span class="st0">"c.warehouse.number = :warehouseNumber AND "</span> +
 <span class="st0">"NOT (c.number = :number) "</span><span class="br0">)</span><span

class="sy0">;</span>
 query.<span class="me1">setParameter</span><span class="br0">(</span><span class="st0">"zone"</span>, getWarehouse<span

class="br0">(</span><span class="br0">)</span>.<span class="me1">getZoneNumber</span><span

class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 query.<span class="me1">setParameter</span><span class="br0">(</span><span class="st0">"warehouseNumber"</span>, getWarehouse<span

class="br0">(</span><span class="br0">)</span>.<span class="me1">getNumber</span><span

class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 query.<span class="me1">setParameter</span><span class="br0">(</span><span class="st0">"number"</span>, getNumber<span

class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 <span class="kw2">return</span> query.<span class="me1">getResultList</span><span

class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span></pre>
      As you see this is a conventional getter method. Obviously it must return
      a <em>java.util.Collection</em> whose elements are of type <em>Carrier</em>.
      You don't need to define the field, the setter, or use <i>@OneToMany</i>
      or <i>@ManyToMany</i>. Only the getter is required.<br>
      <h3 id="many-to-many-collections">Many-to-many collections</h3>
      The <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/ManyToMany.html"

          rel="nofollow">@ManyToMany (JPA)</a></em> annotation allows to define
      a collection with many-to-many multiplicity. As following:<br>
      <pre class="java5">@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
<span class="kw2">public</span> <span class="kw2">class</span> Customer <span class="br0">{</span>
 ...
 @ManyToMany
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/org/omg/PortableServer/POAManagerPackage/State.html"><span

class="kw154">State</span></a><span class="sy0">&gt;</span> states<span class="sy0">;</span>
 ...
<span class="br0">}</span>
&nbsp;</pre>
      In this case a customer has a collection of states, but a state can be
      present in several customers.<br>
      <h3 id="toc26"><a name="Model-Collections-Embedded collections"></a>Embedded
        collections</h3>
      Collections of embeddable objects were not available in early JPA
      versions, so we used to simulate them using collections to entities with
      cascade type REMOVE or ALL. OpenXava manages these collections in a
      special way, and we still call them <em>embedded collections</em>.<br>
      Now an example of an embedded collection. In the main entity (for example
      <em>Invoice</em>) you can write:<br>
      <pre class="java5">@OneToMany <span class="br0">(</span>mappedBy=<span class="st0">"invoice"</span>, cascade=CascadeType.<span

class="me1">REMOVE</span><span class="br0">)</span>
<span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a> details<span class="sy0">;</span>
&nbsp;</pre>
      Note that you use <em>CascadeType.REMOVE</em>, and <em>InvoiceDetail</em>
      is an entity, not an embeddable class:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">java.math.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">org.hibernate.annotations.Columns</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.hibernate.annotations.Type</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.hibernate.annotations.Parameter</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.hibernate.annotations.GenericGenerator</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.calculators.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.test.validators.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
@EntityValidator<span class="br0">(</span>value=InvoiceDetailValidator.<span class="kw2">class</span>,
 properties= <span class="br0">{</span>
 @PropertyValue<span class="br0">(</span>name=<span class="st0">"invoice"</span><span

class="br0">)</span>,
 @PropertyValue<span class="br0">(</span>name=<span class="st0">"oid"</span><span

class="br0">)</span>,
 @PropertyValue<span class="br0">(</span>name=<span class="st0">"product"</span><span

class="br0">)</span>,
 @PropertyValue<span class="br0">(</span>name=<span class="st0">"unitPrice"</span><span

class="br0">)</span>
 <span class="br0">}</span>
<span class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> InvoiceDetail <span

class="br0">{</span>
&nbsp;
 @ManyToOne <span class="co1">// Lazy fetching produces a fails on removing a detail from invoice</span>
 <span class="kw2">private</span> Invoice invoice<span class="sy0">;</span>
&nbsp;
 @Id @GeneratedValue<span class="br0">(</span>generator=<span class="st0">"system-uuid"</span><span

class="br0">)</span> @Hidden
 @GenericGenerator<span class="br0">(</span>name=<span class="st0">"system-uuid"</span>, strategy = <span

class="st0">"uuid"</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> oid<span class="sy0">;</span>
&nbsp;
 <span class="kw2">private</span> ServiceType serviceType<span class="sy0">;</span>
 <span class="kw2">public</span> <span class="kw2">enum</span> ServiceType <span

class="br0">{</span> SPECIAL, URGENT <span class="br0">}</span>
&nbsp;
 @Column<span class="br0">(</span>length=<span class="nu0">4</span><span class="br0">)</span> @Required
 <span class="kw2">private</span> <span class="kw3">int</span> quantity<span class="sy0">;</span>
&nbsp;
 @Stereotype<span class="br0">(</span><span class="st0">"MONEY"</span><span class="br0">)</span> @Required
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> unitPrice<span class="sy0">;</span>
&nbsp;
 @ManyToOne<span class="br0">(</span>fetch=FetchType.<span class="me1">LAZY</span>, optional=<span

class="kw4">false</span><span class="br0">)</span>
 <span class="kw2">private</span> Product product<span class="sy0">;</span>
&nbsp;
 @DefaultValueCalculator<span class="br0">(</span>CurrentDateCalculator.<span class="kw2">class</span><span

class="br0">)</span>
 <span class="kw2">private</span> java.<span class="me1">util</span>.<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Date"><span

class="kw166">Date</span></a> deliveryDate<span class="sy0">;</span>
&nbsp;
 @ManyToOne<span class="br0">(</span>fetch=FetchType.<span class="me1">LAZY</span><span

class="br0">)</span>
 <span class="kw2">private</span> Seller soldBy<span class="sy0">;</span>
&nbsp;
 @Stereotype<span class="br0">(</span><span class="st0">"MEMO"</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> remarks<span class="sy0">;</span>
&nbsp;
 @Stereotype<span class="br0">(</span><span class="st0">"MONEY"</span><span class="br0">)</span> @Depends<span

class="br0">(</span><span class="st0">"unitPrice, quantity"</span><span class="br0">)</span>
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> getAmount<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> getUnitPrice<span class="br0">(</span><span class="br0">)</span>.<span

class="me1">multiply</span><span class="br0">(</span><span class="kw2">new</span> <a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a><span class="br0">(</span>getQuantity<span class="br0">(</span><span

class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">boolean</span> isFree<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> getAmount<span class="br0">(</span><span class="br0">)</span>.<span

class="me1">compareTo</span><span class="br0">(</span><span class="kw2">new</span> <a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a><span class="br0">(</span><span class="st0">"0"</span><span

class="br0">)</span><span class="br0">)</span> <span class="sy0">&lt;</span>= <span

class="nu0">0</span><span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 @PostRemove
 <span class="kw2">private</span> <span class="kw3">void</span> postRemove<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
 invoice.<span class="me1">setComment</span><span class="br0">(</span>invoice.<span

class="me1">getComment</span><span class="br0">(</span><span class="br0">)</span> + <span

class="st0">"DETAIL DELETED"</span><span class="br0">)</span><span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getOid<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> oid<span class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> <span class="kw3">void</span> setOid<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> oid<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">oid</span> = oid<span class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> ServiceType getServiceType<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> serviceType<span class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> <span class="kw3">void</span> setServiceType<span

class="br0">(</span>ServiceType serviceType<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">serviceType</span> = serviceType<span

class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> <span class="kw3">int</span> getQuantity<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> quantity<span class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> <span class="kw3">void</span> setQuantity<span

class="br0">(</span><span class="kw3">int</span> quantity<span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">quantity</span> = quantity<span

class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> getUnitPrice<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> unitPrice==<span class="kw4">null</span><span class="sy0">?</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a>.<span class="me1">ZERO</span>:unitPrice<span

class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> <span class="kw3">void</span> setUnitPrice<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> unitPrice<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">unitPrice</span> = unitPrice<span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> Product getProduct<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> product<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setProduct<span class="br0">(</span>Product product<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">product</span> = product<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> java.<span class="me1">util</span>.<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Date"><span

class="kw166">Date</span></a> getDeliveryDate<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> deliveryDate<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setDeliveryDate<span

class="br0">(</span>java.<span class="me1">util</span>.<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Date"><span

class="kw166">Date</span></a> deliveryDate<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">deliveryDate</span> = deliveryDate<span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> Seller getSoldBy<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> soldBy<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setSoldBy<span class="br0">(</span>Seller soldBy<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">soldBy</span> = soldBy<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getRemarks<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> remarks<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setRemarks<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> remarks<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">remarks</span> = remarks<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> Invoice getInvoice<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> invoice<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setInvoice<span class="br0">(</span>Invoice invoice<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">invoice</span> = invoice<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre>
      As you see this is a complex entity, with calculators, validators,
      references and so on. Also you have to define a reference to the container
      class (<em>invoice</em>). In this case when an <em>Invoice</em> is
      removed all its details are removed too. Moreover there are differences at
      user interface level (you can learn more on the <a class="wiki_link" href="view_en.html">view</a>
      chapter).<br>
      <h3 id="toc27"><a name="Model-Collections-Element collections (new in v5.0)"></a>Element
        collections <em>(new in v5.0)</em></h3>
      Since JPA 2.0 you can define a collection of real <a class="wiki_link" href="#Model-Embeddable%20classes">embeddable
        objects</a>. We call these collections <em>element collections</em>.<br>
      This is the syntax for element collections:<br>
      <pre class="java5">@Size <span class="co1">// 1</span>
@OrderBy <span class="co1">// 2</span>
@OrderColumn <span class="co1">// 3  New in v5.3</span>
@ElementCollection <span class="co1">// 4</span>
<span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>YourEmbeddableClass<span

class="sy0">&gt;</span> collectionName<span class="sy0">;</span> <span class="co1">// 3</span>
<span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>YourEmbeddableClass<span

class="sy0">&gt;</span> getCollectionName<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span> ... <span class="br0">}</span> <span class="co1">// 3</span>
<span class="kw2">public</span> <span class="kw3">void</span> setCollectionName<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>YourEmbeddableClass<span

class="sy0">&gt;</span> newValue<span class="br0">)</span> <span class="br0">{</span> ... <span

class="br0">}</span> <span class="co1">// 3</span>
&nbsp;</pre>
      <ol>
        <li><strong>@Size</strong> (<a class="wiki_link_ext" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/javax/validation/constraints/Size.html"

            rel="nofollow">BV</a>, <a class="wiki_link_ext" href="http://www.hibernate.org/hib_docs/validator/api/org/hibernate/validator/Size.html"

            rel="nofollow">HV</a>, optional): Minimum (<em>min</em>) and/or
          maximum (<em>max</em>) number of expected elements. This is validated
          just before saving.</li>
        <li><strong>@OrderBy</strong> (<a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/OrderBy.html"

            rel="nofollow">JPA</a>, optional): The elements in collections will
          be in the indicated order.</li>
        <li><strong><a class="wiki_link" href="model_en.html#Model-Collections-Lists%20with%20@OrderColumn%20%28new%20in%20v5.3%29">@OrderColumn</a></strong>
          (<a class="wiki_link_ext" href="http://docs.oracle.com/javaee/7/api/javax/persistence/OrderColumn.html"

            rel="nofollow">JPA</a>, optional): <em>(New in v5.3)</em> The order
          of the elements in the collection is persisted in database. A special
          column is created in the table to keep this order. The collection must
          be a <em>java.util.List</em>. The user interface allows the user to
          reorder the collection elements.</li>
        <li><strong>Collection declaration</strong>: A regular Java collection
          declaration with its getters and setters. The collection is marked
          with <em><a class="wiki_link_ext" href="http://docs.oracle.com/javaee/6/api/javax/persistence/ElementCollection.html"

              rel="nofollow">@ElementCollection (JPA)</a></em>. The elements
          must be <a class="wiki_link" href="#Model-Embeddable%20classes">embeddable
            classes</a>.</li>
      </ol>
      The elements in the collection are saved all at once at the same time of
      the main entity. Moreover, the generated user interface allows the user to
      modify all the elements of the collection at the same time.<br>
      An embeddable class that is contained within an element collection must
      not contain collections of any type.<br>
      <br>
      Let's see an example. First you have to define the collection in the main
      entity:<br>
      <pre class="java5">@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
<span class="kw2">public</span> <span class="kw2">class</span> Quote <span class="kw2">extends</span> Identifiable <span

class="br0">{</span>
    ...
    @ElementCollection
    <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>QuoteDetail<span

class="sy0">&gt;</span> details<span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>QuoteDetail<span

class="sy0">&gt;</span> getDetails<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
        <span class="kw2">return</span> details<span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">public</span> <span class="kw3">void</span> setDetails<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>QuoteDetail<span

class="sy0">&gt;</span> details<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw2">this</span>.<span class="me1">details</span> = details<span

class="sy0">;</span>
    <span class="br0">}</span>
    ...
<span class="br0">}</span></pre>
      Then define your embeddable class:<br>
      <pre class="java5">@Embeddable
<span class="kw2">public</span> <span class="kw2">class</span> QuoteDetail <span

class="br0">{</span>
&nbsp;
    @ManyToOne<span class="br0">(</span>fetch=FetchType.<span class="me1">LAZY</span>, optional=<span

class="kw4">false</span><span class="br0">)</span> <span class="co1">// 1</span>
    <span class="kw2">private</span> Product product<span class="sy0">;</span>
&nbsp;
    @Required <span class="co1">// 2</span>
    <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> unitPrice<span class="sy0">;</span>
&nbsp;
    @Required
    <span class="kw2">private</span> <span class="kw3">int</span> quantity<span

class="sy0">;</span>
&nbsp;
    <span class="kw2">private</span> <a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Date"><span

class="kw166">Date</span></a> availabilityDate<span class="sy0">;</span>
&nbsp;
    @Column<span class="br0">(</span>length=<span class="nu0">30</span><span class="br0">)</span>
    <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> remarks<span class="sy0">;</span>
&nbsp;
    @Column<span class="br0">(</span>precision=<span class="nu0">10</span>, scale=<span

class="nu0">2</span><span class="br0">)</span>
    @Depends<span class="br0">(</span><span class="st0">"unitPrice, quantity"</span><span

class="br0">)</span>
    <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> getAmount<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span> <span class="co1">// 3</span>
        <span class="kw2">return</span> getUnitPrice<span class="br0">(</span><span

class="br0">)</span>.<span class="me1">multiply</span><span class="br0">(</span><span

class="kw2">new</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a><span class="br0">(</span>getQuantity<span class="br0">(</span><span

class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    ...
<span class="br0">}</span></pre>
      As you can see, an embeddable class used in an element collection can
      contain references(1), validations(2) and calculated properties(3) among
      other things.<br>
      <h3 id="toc28"><a name="Model-Collections-Lists with @OrderColumn (new in v5.3)"></a>Lists
        with @OrderColumn <em>(new in v5.3)</em></h3>
      To have a collection that keeps the order of its elements use <em>java.util.List</em>
      instead of <em>java.util.Collection</em> and annotate the collection with
      <em><a class="wiki_link_ext" href="http://docs.oracle.com/javaee/7/api/javax/persistence/OrderColumn.html"

          rel="nofollow">@OrderColumn</a></em>. That is, if you define a
      collection in this way:<br>
      <pre class="java5">@OneToMany<span class="br0">(</span>mappedBy=<span class="st0">"project"</span>, cascade=CascadeType.<span

class="me1">ALL</span><span class="br0">)</span>
@OrderColumn
<span class="kw2">private</span> <a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+List"><span

class="kw166">List</span></a><span class="sy0">&lt;</span>ProjectTask<span class="sy0">&gt;</span> tasks<span

class="sy0">;</span></pre>
      The user interface allows the user to change the order of the elements and
      this order is persisted in database. Moreover, if you change the order of
      the elements programmatically this order is persisted in database too.<br>
      To persist the order, JPA uses a special column in the database table,
      this column is for internal use only, you have not a property to access it
      from your code. You can use <em>@OrderColumn(name="MYCOLUMN")</em> to
      specify the column name you want, if <em>name</em> is not specified the
      collection name plus "_ORDER" is used. If you use the <em>updateSchema</em>
      tool it will create the column for you. Otherwise, if you control the
      database schema by yourself you should add the column to your table, for
      example for the above collection you should add the next column to your
      table:<br>
      <pre><code class="language-sql">ALTER TABLE PROJECTTASK
ADD TASKS_ORDER INTEGER</code></pre>
      In the current implementation drag and drop is used by the user to change
      the order, with <em>@OneToMany</em> collections the order is persisted
      just after drop, while in <em>@ElementCollection</em> the order is
      persisted after saving the container entity.<br>
      <h2 id="toc29"><a name="Model-Methods"></a>Methods</h2>
      Methods are defined in an OpenXava entity (really a JPA entity) as in a
      regular Java class. For example:<br>
      <pre><code class="language-java">public void increasePrice() {
 setUnitPrice(getUnitPrice().multiply(new BigDecimal("1.02")).setScale(2));
}</code></pre>
      Methods are the sauce of the objects, without them the object would only
      be a silly wrapper of data. When possible it is better to put the business
      logic in methods (model layer) instead of in actions (controller layer).<br>
      <h2 id="toc30"><a name="Model-Finders"></a>Finders</h2>
      A finder is a special static method that allows you to find an object or a
      collection of objects that follow some criteria.<br>
      Some examples:<br>
      <pre><code class="language-java">public static Customer findByNumber(int number) throws NoResultException {
 Query query = XPersistence.getManager().createQuery(
 "from Customer as o where o.number = :number");
 query.setParameter("number", number);
 return (Customer) query.getSingleResult();
}

public static Collection findAll() {
 Query query = XPersistence.getManager().createQuery("from Customer as o");
 return query.getResultList();
}

public static Collection findByNameLike(String name) {
 Query query = XPersistence.getManager().createQuery(
 "from Customer as o where o.name like :name order by o.name desc");
 query.setParameter("name", name);
 return query.getResultList();
}</code></pre>
      This methods can be used this way:<br>
      <pre><code class="language-java">Customer customer = Customer.findByNumber(8);
Collection javieres = Customer.findByNameLike("%JAVI%");</code></pre>
      As you see, using finder methods creates a more readable code than using
      the verbose query API of JPA. But this is only a style recommendation, you
      can choose not to write finder methods and to use directly JPA queries.<br>
      <h2 id="toc31"><a name="Model-Entity validator"></a>Entity validator</h2>
      An <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/EntityValidator.html"

          rel="nofollow">@EntityValidator</a></em> allows to define a validation
      at model level. When you need to make a validation on several properties
      at a time, and that validation does not correspond logically with any of
      them, then you can use this type of validation.<br>
      Its syntax is:<br>
      <pre><code class="language-java">@EntityValidator(
 value=class, // 1
 onlyOnCreate=(true|false), // 2
 properties={ @PropertyValue ... } // 3
)
</code></pre>
      <ol>
        <li><strong>value</strong> (required): Class that implements the
          validation logic. It has to be of type <em>IValidator</em>.</li>
        <li><strong>onlyOnCreate</strong> (optional): If true the validator is
          executed only when creating a new object, not when an existing object
          is modified. The default value is false.</li>
        <li><strong>properties</strong> (several <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValue.html"

              rel="nofollow">@PropertyValue</a></em>, optional): To set a value
          of the validator properties before executing it.</li>
      </ol>
      An example:<br>
      <pre><code class="language-java">@EntityValidator(value=org.openxava.test.validators.CheapProductValidator.class, properties= {
 @PropertyValue(name="limit", value="100"),
 @PropertyValue(name="description"),
 @PropertyValue(name="unitPrice")
})
public class Product {</code></pre>
      And the validator code:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.validators</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">java.math.*</span><span class="sy0">;</span>
&nbsp;
<span class="co3">/**
 * @author Javier Paniza
 */</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> CheapProductValidator <span

class="kw2">implements</span> IValidator <span class="br0">{</span> <span class="co1">// 1</span>
&nbsp;
 <span class="kw2">private</span> <span class="kw3">int</span> limit<span class="sy0">;</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> unitPrice<span class="sy0">;</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> description<span class="sy0">;</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> validate<span class="br0">(</span>Messages errors<span

class="br0">)</span> <span class="br0">{</span> <span class="co1">// 2</span>
 <span class="kw1">if</span> <span class="br0">(</span>getDescription<span class="br0">(</span><span

class="br0">)</span>.<span class="me1">indexOf</span><span class="br0">(</span><span

class="st0">"CHEAP"</span><span class="br0">)</span> <span class="sy0">&gt;</span>= <span

class="nu0">0</span> ||
 getDescription<span class="br0">(</span><span class="br0">)</span>.<span class="me1">indexOf</span><span

class="br0">(</span><span class="st0">"BARATO"</span><span class="br0">)</span> <span

class="sy0">&gt;</span>= <span class="nu0">0</span> ||
 getDescription<span class="br0">(</span><span class="br0">)</span>.<span class="me1">indexOf</span><span

class="br0">(</span><span class="st0">"BARATA"</span><span class="br0">)</span> <span

class="sy0">&gt;</span>= <span class="nu0">0</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw1">if</span> <span class="br0">(</span>getLimiteBd<span class="br0">(</span><span

class="br0">)</span>.<span class="me1">compareTo</span><span class="br0">(</span>getUnitPrice<span

class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="sy0">&lt;</span> <span

class="nu0">0</span><span class="br0">)</span> <span class="br0">{</span>
 errors.<span class="me1">add</span><span class="br0">(</span><span class="st0">"cheap_product"</span>, getLimitBd<span

class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span> <span

class="co1">// 3</span>
 <span class="br0">}</span>
 <span class="br0">}</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> getUnitPrice<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> unitPrice<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setUnitPrice<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> decimal<span class="br0">)</span> <span class="br0">{</span>
 unitPrice = decimal<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getDescription<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> description==<span class="kw4">null</span><span

class="sy0">?</span><span class="st0">""</span>:description<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setDescription<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> string<span class="br0">)</span> <span class="br0">{</span>
 description = string<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getLimit<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> limit<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setLimit<span class="br0">(</span><span

class="kw3">int</span> i<span class="br0">)</span> <span class="br0">{</span>
 limit = i<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a> getLimitBd<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> <span class="kw2">new</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/math/BigDecimal.html"><span

class="kw27">BigDecimal</span></a><span class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/Integer.html"><span

class="kw21">Integer</span></a>.<span class="me1">toString</span><span class="br0">(</span>limit<span

class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;</pre>
      This validator must implement <em>IValidator</em> (1), this forces you to
      write a <em>validate(Messages messages)</em> (2). In this method you add
      the error message ids (3) (whose texts are in the i18n files). And if the
      validation process (that is the execution of all validators) produces some
      error, then OpenXava does not save the object and displays the errors to
      the user.<br>
      In this case you see how <em>description</em> and <em>unitPrice</em>
      properties are used to validate, for that reason the validation is at
      model level and not at individual property level, because the scope of
      validation is more than one property.<br>
      Since v4.6.1 the validator can implement <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/validators/IWithMessage.html"

          rel="nofollow">IWithMessage</a></em> to inject the message from <em>@EntityValidator</em>,
      it works like in the <a class="wiki_link" href="#Model-Properties-Property%20validator">property
        validator case</a>.</div>
    <div class="wiki" style="display: block;"> You can define more than one
      validator for entity, as following:<br>
      <div class="wiki" id="content_view">
        <pre class="java5">@EntityValidator<span class="br0">(</span>value=org.<span

class="me1">openxava</span>.<span class="me1">test</span>.<span class="me1">validators</span>.<span

class="me1">CheapProductValidator</span>.<span class="kw2">class</span>, properties= <span

class="br0">{</span>
    @PropertyValue<span class="br0">(</span>name=<span class="st0">"limit"</span>, value=<span

class="st0">"100"</span><span class="br0">)</span>,
    @PropertyValue<span class="br0">(</span>name=<span class="st0">"description"</span><span

class="br0">)</span>,
    @PropertyValue<span class="br0">(</span>name=<span class="st0">"unitPrice"</span><span

class="br0">)</span>
<span class="br0">}</span><span class="br0">)</span>
@EntityValidator<span class="br0">(</span>value=org.<span class="me1">openxava</span>.<span

class="me1">test</span>.<span class="me1">validators</span>.<span class="me1">ExpensiveProductValidator</span>.<span

class="kw2">class</span>, properties= <span class="br0">{</span>
    @PropertyValue<span class="br0">(</span>name=<span class="st0">"limit"</span>, value=<span

class="st0">"1000"</span><span class="br0">)</span>,
    @PropertyValue<span class="br0">(</span>name=<span class="st0">"description"</span><span

class="br0">)</span>,
    @PropertyValue<span class="br0">(</span>name=<span class="st0">"unitPrice"</span><span

class="br0">)</span>
<span class="br0">}</span><span class="br0">)</span>
@EntityValidator<span class="br0">(</span>value=org.<span class="me1">openxava</span>.<span

class="me1">test</span>.<span class="me1">validators</span>.<span class="me1">ForbiddenPriceValidator</span>.<span

class="kw2">class</span>,
    properties= <span class="br0">{</span>
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"forbiddenPrice"</span>, value=<span

class="st0">"555"</span><span class="br0">)</span>,
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"unitPrice"</span><span

class="br0">)</span>
 <span class="br0">   }</span>,
    onlyOnCreate=<span class="kw4">true</span>
<span class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> Product <span class="br0">{</span> </pre>
        With OpenXava previous to 6.1 you need to use <em>@EntityValidators</em>
        to define several validators:</div>
    </div>
    <div class="wiki" style="display: block;">
      <pre class="java5">@EntityValidators<span class="br0">(</span><span class="br0">{ // Only needed until v6.0.2</span>
    @EntityValidator<span class="br0">(</span>value=org.<span class="me1">openxava</span>.<span

class="me1">test</span>.<span class="me1">validators</span>.<span class="me1">CheapProductValidator</span>.<span

class="kw2">class</span>, properties= <span class="br0">{</span>
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"limit"</span>, value=<span

class="st0">"100"</span><span class="br0">)</span>,
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"description"</span><span

class="br0">)</span>,
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"unitPrice"</span><span

class="br0">)</span>
    <span class="br0">}</span><span class="br0">)</span>,
    @EntityValidator<span class="br0">(</span>value=org.<span class="me1">openxava</span>.<span

class="me1">test</span>.<span class="me1">validators</span>.<span class="me1">ExpensiveProductValidator</span>.<span

class="kw2">class</span>, properties= <span class="br0">{</span>
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"limit"</span>, value=<span

class="st0">"1000"</span><span class="br0">)</span>,
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"description"</span><span

class="br0">)</span>,
        @PropertyValue<span class="br0">(</span>name=<span class="st0">"unitPrice"</span><span

class="br0">)</span>
    <span class="br0">}</span><span class="br0">)</span>,
    @EntityValidator<span class="br0">(</span>value=org.<span class="me1">openxava</span>.<span

class="me1">test</span>.<span class="me1">validators</span>.<span class="me1">ForbiddenPriceValidator</span>.<span

class="kw2">class</span>,
        properties= <span class="br0">{</span>
            @PropertyValue<span class="br0">(</span>name=<span class="st0">"forbiddenPrice"</span>, value=<span

class="st0">"555"</span><span class="br0">)</span>,
            @PropertyValue<span class="br0">(</span>name=<span class="st0">"unitPrice"</span><span

class="br0">)</span>
        <span class="br0">}</span>,
        onlyOnCreate=<span class="kw4">true</span>
 <span class="br0">   )</span>
<span class="br0">}</span><span class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> Product <span class="br0">{</span>
</pre> <em>@EntityValidator</em> is defined as a <a class="wiki_link" href="#Model-Bean%20Validation">Bean
        Validation</a> constraint since v5.3 and as a <a class="wiki_link" href="#Model-Hibernate%20Validator%20%28new%20in%20v3.0.1%29">Hibernate
        Validator</a> constraint until v5.2.x.<br>
      If you need to use JPA in your validator, please see <a class="wiki_link"

        href="#Model-JPA%20callback%20methods">Using JPA from a Validator or
        Callback</a>.<br>
      <h2 id="toc32"><a name="Model-Remove validator"></a>Remove validator</h2>
      The <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/RemoveValidator.html"

          rel="nofollow">@RemoveValidator</a></em> is a level model validator
      too, but in this case it is executed just before removing an object, and
      it has the possibility to deny the deletion.<br>
      Its syntax is:<br>
      <pre class="java5">@RemoveValidator<span class="br0">(</span>
 value=<span class="kw2">class</span>, <span class="co1">// 1</span>
 properties=<span class="br0">{</span> @PropertyValue ... <span class="br0">}</span> <span

class="co1">// 2</span>
<span class="br0">)</span>
&nbsp;</pre>
      <ol>
        <li><strong>class</strong> (required): Class that implements the
          validation logic. Must implement <em>IRemoveValidator</em>.</li>
        <li><strong>properties</strong> (several <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValue.html"

              rel="nofollow">@PropertyValue</a></em>, optional): To set the
          value of the validator properties before executing it.</li>
      </ol>
      An example can be:<br>
      <pre class="java5">@RemoveValidator<span class="br0">(</span>value=DeliveryTypeRemoveValidator.<span

class="kw2">class</span>,
 properties=@PropertyValue<span class="br0">(</span>name=<span class="st0">"number"</span><span

class="br0">)</span>
<span class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> DeliveryType <span

class="br0">{</span>
&nbsp;</pre>
      And the validator:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.validators</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">org.openxava.test.model.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.util.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.validators.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 * @author Javier Paniza
 */</span>
<span class="kw2">public</span> <span class="kw2">class</span> DeliveryTypeRemoveValidator <span

class="kw2">implements</span> IRemoveValidator <span class="br0">{</span> <span

class="co1">// 1</span>
&nbsp;
 <span class="kw2">private</span> DeliveryType deliveryType<span class="sy0">;</span>
 <span class="kw2">private</span> <span class="kw3">int</span> number<span class="sy0">;</span> <span

class="co1">// We use this (instead of obtaining it from deliveryType)</span>
 <span class="co1">// for testing @PropertyValue for simple properties</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setEntity<span class="br0">(</span><a

href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Object"><span

class="kw166">Object</span></a> entity<span class="br0">)</span> <span class="kw2">throws</span> <a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/Exception.html"><span

class="kw21">Exception</span></a> <span class="br0">{</span> <span class="co1">// 2</span>
 <span class="kw2">this</span>.<span class="me1">deliveryType</span> = <span class="br0">(</span>DeliveryType<span

class="br0">)</span> entity<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> validate<span class="br0">(</span>Messages errors<span

class="br0">)</span> <span class="kw2">throws</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/Exception.html"><span

class="kw21">Exception</span></a> <span class="br0">{</span>
 <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span>deliveryType.<span

class="me1">getDeliveries</span><span class="br0">(</span><span class="br0">)</span>.<span

class="me1">isEmpty</span><span class="br0">(</span><span class="br0">)</span><span

class="br0">)</span> <span class="br0">{</span>
 errors.<span class="me1">add</span><span class="br0">(</span><span class="st0">"not_remove_delivery_type_if_in_deliveries"</span>, <span

class="kw2">new</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/Integer.html"><span

class="kw21">Integer</span></a><span class="br0">(</span>getNumber<span class="br0">(</span><span

class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span> <span

class="co1">// 3</span>
 <span class="br0">}</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getNumber<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setNumber<span class="br0">(</span><span

class="kw3">int</span> number<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">number</span> = number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;</pre>
      As you see this validator must implement <em>IRemoveValidator</em> (1)
      this forces you to write a <em>setEntity()</em> (2) method that receives
      the object to remove. If validation error is added to the <em>Messages</em>
      object sent to <em>validate()</em> (3) the validation fails. If after
      executing all validations there are validation errors, then OpenXava does
      not remove the object and displays a list of validation messages to the
      user.<br>
      In this case it verifies if there are deliveries that use this delivery
      type before deleting it.<br>
      As in the case of <em>@EntityValidator</em> you can use several <em>@RemoveValidator</em>
      for entity (with <em>@RemoveValidators</em> annotation for versions older
      than 6.1).<br>
      <em>@RemoveValidator</em> is executed when you remove entities from
      OpenXava (using <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/model/MapFacade.html"

          rel="nofollow">MapFacade</a></em> or standard OX actions), but not
      when you use directly JPA. If you want to create a restriction on remove
      which is recognized by JPA, just use <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PreRemove.html"

          rel="nofollow">@PreRemove</a></em> JPA call method.<br>
      <h2 id="toc33"><a name="Model-JPA callback methods"></a>JPA callback
        methods</h2>
      With <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PrePersist.html"

          rel="nofollow">@PrePersist</a></em> you can plug in your own logic to
      execute just before creating the object as persistent object.<br>
      As following:<br>
      <pre class="java5">@PrePersist
<span class="kw2">private</span> <span class="kw3">void</span> prePersist<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 setDescription<span class="br0">(</span>getDescription<span class="br0">(</span><span

class="br0">)</span> + <span class="st0">" CREATED"</span><span class="br0">)</span><span

class="sy0">;</span>
<span class="br0">}</span></pre>
      In this case each time that a <em>DeliveryType</em> is created a suffix
      to description is added.<br>
      As you see, this is exactly the same as in other methods but is
      automatically executed just before creation.<br>
      With <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PreUpdate.html"

          rel="nofollow">@PreUpdate</a></em> you can plug in some logic to
      execute after the state of the object is changed and just before it is
      stored in the database, that is, just before executing UPDATE against
      database.<br>
      As following:<br>
      <pre class="java5">@PreUpdate
<span class="kw2">private</span> <span class="kw3">void</span> preUpdate<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 setDescription<span class="br0">(</span>getDescription<span class="br0">(</span><span

class="br0">)</span> + <span class="st0">" MODIFIED"</span><span class="br0">)</span><span

class="sy0">;</span>
<span class="br0">}</span></pre>
      In this case whenever that a <em>DeliveryType</em> is modified a suffix
      is added to its description.<br>
      As you see, this is exactly the same as in other methods, but it is
      executed just before modifying.<br>
      You can use all the JPA callback annotations: <em><a class="wiki_link_ext"

          href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PrePersist.html"

          rel="nofollow">@PrePersist</a></em>, <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PostPersist.html"

          rel="nofollow">@PostPersist</a></em>, <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PreRemove.html"

          rel="nofollow">@PreRemove</a></em>, <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PostRemove.html"

          rel="nofollow">@PostRemove</a></em>, <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PreUpdate.html"

          rel="nofollow">@PreUpdate</a></em>, <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PostUpdate.html"

          rel="nofollow">@PostUpdate</a></em> and <em><a class="wiki_link_ext"

          href="http://java.sun.com/javaee/5/docs/api/javax/persistence/PostLoad.html"

          rel="nofollow">@PostLoad</a></em>.<br>
      <h2 id="toc34"><a name="Model-OX callback methods (new in V4.0.1)"></a>OX
        callback methods (new in V4.0.1)</h2>
      Using @PreCreate you can perform logic that will be executed before
      persisting the object. It allows to perform entity manager operations and
      queries that are not allowed in JPA callbacks.<br>
      <br>
      For example, if we need to create a customer and assign it to an invoice
      when the customer is not specified:<br>
      <pre class="java5">@PreCreate
<span class="kw2">public</span> <span class="kw3">void</span> onPreCreate<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="co1">// Automatically create a new customer</span>
 <span class="kw1">if</span> <span class="br0">(</span>getCustomer<span class="br0">(</span><span

class="br0">)</span> == <span class="kw4">null</span><span class="br0">)</span> <span

class="br0">{</span>
 Customer cust = <span class="kw2">new</span> Customer<span class="br0">(</span><span

class="br0">)</span><span class="sy0">;</span>
 cust.<span class="me1">setName</span><span class="br0">(</span>getName<span class="br0">(</span><span

class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 cust.<span class="me1">setAddress</span><span class="br0">(</span>getAddress<span

class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 cust = XPersistence.<span class="me1">getManager</span><span class="br0">(</span><span

class="br0">)</span>.<span class="me1">merge</span><span class="br0">(</span>cust<span

class="br0">)</span><span class="sy0">;</span>
 setCustomer<span class="br0">(</span>cust<span class="br0">)</span><span class="sy0">;</span>
 <span class="br0">}</span>
<span class="br0">}</span></pre>
      The entity manager operation will not affect the callbacks behavior. Along
      with @PreCreate is @PostCreate and @PreDelete the methods decorated with
      these annotations are part of the transaction, therefore the use of these
      annotations keeps the integrity of the information without further effort
      from the developer. When combined with JPA annotations the order for each
      callback is as follows:<br>
      For creating an entity: @PreCreate, @PrePersist(JPA), @PostPersist(JPA)
      and @PostCreate.<br>
      For deleting and entity: @PreDelete, @PreRemove(JPA), @PostRemove(JPA).<br>
      The methods annotated with these annotations should not return any value
      and must not have any parameters. These annotations are intended for the
      entities, and are ignored when used on entity listeners.<br>
      <h2 id="toc35"><a name="Model-Inheritance"></a>Inheritance</h2>
      OpenXava supports Java and <a class="wiki_link_ext" href="http://en.wikibooks.org/wiki/Java_Persistence/Inheritance"

        rel="nofollow">JPA inheritance</a>.<br>
      For example you can define a <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/MappedSuperclass.html"

          rel="nofollow">@MappedSuperclass</a></em> in this way:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">org.hibernate.annotations.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 * Base class for defining entities with a UUID oid. &lt;p&gt;
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@MappedSuperclass
<span class="kw2">public</span> <span class="kw2">class</span> Identifiable <span

class="br0">{</span>
&nbsp;
 @Id @GeneratedValue<span class="br0">(</span>generator=<span class="st0">"system-uuid"</span><span

class="br0">)</span> @Hidden
 @GenericGenerator<span class="br0">(</span>name=<span class="st0">"system-uuid"</span>, strategy = <span

class="st0">"uuid"</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> oid<span class="sy0">;</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getOid<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> oid<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setOid<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> oid<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">oid</span> = oid<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;</pre>
      You can define another <em>@MappedSuperclass</em> that extends from this
      one, for example:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 * Base class for entities with a 'name' property. &lt;p&gt;
 *
 * @author Javier Paniza
 */</span>
@MappedSuperclass
<span class="kw2">public</span> <span class="kw2">class</span> Nameable <span class="kw2">extends</span> Identifiable <span

class="br0">{</span>
&nbsp;
 @Column<span class="br0">(</span>length=<span class="nu0">50</span><span class="br0">)</span> @Required
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> name<span class="sy0">;</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getName<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> name<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setName<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> name<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">name</span> = name<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;</pre>
      Now you can use <em>Identifiable</em> or <em>Nameable</em> for defining
      your entities, as following:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
@DiscriminatorColumn<span class="br0">(</span>name=<span class="st0">"TYPE"</span><span

class="br0">)</span>
@DiscriminatorValue<span class="br0">(</span><span class="st0">"HUM"</span><span

class="br0">)</span>
@Table<span class="br0">(</span>name=<span class="st0">"PERSON"</span><span class="br0">)</span>
@AttributeOverrides<span class="br0">(</span>
 @AttributeOverride<span class="br0">(</span>name=<span class="st0">"name"</span>, column=@Column<span

class="br0">(</span>name=<span class="st0">"PNAME"</span><span class="br0">)</span><span

class="br0">)</span>
<span class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> Human <span class="kw2">extends</span> Nameable <span

class="br0">{</span>
&nbsp;
 @Enumerated<span class="br0">(</span>EnumType.<span class="me1">STRING</span><span

class="br0">)</span>
 <span class="kw2">private</span> Sex sex<span class="sy0">;</span>
 <span class="kw2">public</span> <span class="kw2">enum</span> Sex <span class="br0">{</span> MALE, FEMALE <span

class="br0">}</span><span class="sy0">;</span>
&nbsp;
 <span class="kw2">public</span> Sex getSex<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> sex<span class="sy0">;</span>
 <span class="br0">}</span>
 <span class="kw2">public</span> <span class="kw3">void</span> setSex<span class="br0">(</span>Sex sex<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">sex</span> = sex<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;</pre>
      And now, the real entity inheritance, an entity that extends other entity:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
@DiscriminatorValue<span class="br0">(</span><span class="st0">"PRO"</span><span

class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> Programmer <span

class="kw2">extends</span> Human <span class="br0">{</span>
&nbsp;
 @Column<span class="br0">(</span>length=<span class="nu0">20</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> mainLanguage<span class="sy0">;</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getMainLanguage<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> mainLanguage<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setMainLanguage<span

class="br0">(</span><a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> mainLanguage<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">mainLanguage</span> = mainLanguage<span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;</pre>
      You can create an <a class="wiki_link" href="application_en.html">OpenXava
        module</a> for <em>Human</em> and <em>Programmer</em> (not for <em>Identifiable</em>
      or <em>Nameble</em> directly). In the <em>Programmer</em> module the
      user can only access to programmers, in the other hand using <em>Human</em>
      module the user can access to <em>Human</em> and <em>Programmer</em>
      objects. Moreover when the user tries to view the detail of a Programmer
      from the <em>Human</em> module the <em>Programmer</em> view will be
      show. True polymorphism.<br>
      Since v4.5 OpenXava supports all inheritance features of JPA, including
      single table per class hierarchy, joined and table per class mapping
      strategies, before v4.5 only <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/AttributeOverrides.html"

          rel="nofollow">@AttributeOverrides</a></em> and single table per class
      hierarchy mapping strategy was supported.<br>
      <h2 id="toc36"><a name="Model-Composite key"></a>Composite key</h2>
      The preferred way for defining the key of an entity is a single
      autogenerated key (annotated with <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Id.html"

          rel="nofollow">@Id</a></em> and <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/GeneratedValue.html"

          rel="nofollow">@GeneratedValue</a></em>), but sometimes, for example
      when you go against a legacy database, you need to have an entity mapped
      to a table that uses several column as key. This case can be solved with
      JPA (therefore with OpenXava) in two ways, using <em><a class="wiki_link_ext"

          href="http://java.sun.com/javaee/5/docs/api/javax/persistence/IdClass.html"

          rel="nofollow">@IdClass</a></em> or using <em><a class="wiki_link_ext"

          href="http://java.sun.com/javaee/5/docs/api/javax/persistence/EmbeddedId.html"

          rel="nofollow">@EmbeddedId</a></em><br>
      <h3 id="toc37"><a name="Model-Composite key-Id class"></a>Id class</h3>
      In this case you use <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/IdClass.html"

          rel="nofollow">@IdClass</a></em> in your entity to indicate a key
      class, and you mark the key properties as <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Id.html"

          rel="nofollow">@Id</a></em> in your entity:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.jpa.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
@IdClass<span class="br0">(</span>WarehouseKey.<span class="kw2">class</span><span

class="br0">)</span>
<span class="kw2">public</span> <span class="kw2">class</span> Warehouse <span class="br0">{</span>
&nbsp;
 @Id
 <span class="co1">// Column is also specified in WarehouseKey because a bug in Hibernate, see</span>
 <span class="co1">// http://opensource.atlassian.com/projects/hibernate/browse/ANN-361</span>
 @Column<span class="br0">(</span>length=<span class="nu0">3</span>, name=<span

class="st0">"ZONE"</span><span class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">int</span> zoneNumber<span class="sy0">;</span>
&nbsp;
 @Id @Column<span class="br0">(</span>length=<span class="nu0">3</span><span class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">int</span> number<span class="sy0">;</span>
&nbsp;
 @Column<span class="br0">(</span>length=<span class="nu0">40</span><span class="br0">)</span> @Required
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> name<span class="sy0">;</span>
&nbsp;
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getName<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> name<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setName<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> name<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">name</span> = name<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getNumber<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setNumber<span class="br0">(</span><span

class="kw3">int</span> number<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">number</span> = number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getZoneNumber<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> zoneNumber<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setZoneNumber<span

class="br0">(</span><span class="kw3">int</span> zoneNumber<span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">zoneNumber</span> = zoneNumber<span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;
&nbsp;</pre>
      You also need to declare your id class, a serializable regular class with
      all key properties from the entity:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">java.io.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> WarehouseKey <span

class="kw2">implements</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/io/Serializable.html"><span

class="kw20">Serializable</span></a> <span class="br0">{</span>
&nbsp;
 @Column<span class="br0">(</span>name=<span class="st0">"ZONE"</span><span class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">int</span> zoneNumber<span class="sy0">;</span>
 <span class="kw2">private</span> <span class="kw3">int</span> number<span class="sy0">;</span>
&nbsp;
 @<a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/Override.html"><span

class="kw21">Override</span></a>
 <span class="kw2">public</span> <span class="kw3">boolean</span> equals<span class="br0">(</span><a

href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Object"><span

class="kw166">Object</span></a> obj<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw1">if</span> <span class="br0">(</span>obj == <span class="kw4">null</span><span

class="br0">)</span> <span class="kw2">return</span> <span class="kw4">false</span><span

class="sy0">;</span>
 <span class="kw2">return</span> obj.<span class="me1">toString</span><span class="br0">(</span><span

class="br0">)</span>.<span class="me1">equals</span><span class="br0">(</span><span

class="kw2">this</span>.<span class="me1">toString</span><span class="br0">(</span><span

class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 @<a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/Override.html"><span

class="kw21">Override</span></a>
 <span class="kw2">public</span> <span class="kw3">int</span> hashCode<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> toString<span class="br0">(</span><span class="br0">)</span>.<span

class="me1">hashCode</span><span class="br0">(</span><span class="br0">)</span><span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 @<a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/Override.html"><span

class="kw21">Override</span></a>
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> toString<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> <span class="st0">"WarehouseKey::"</span> + zoneNumber+ <span

class="st0">":"</span> + number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getNumber<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setNumber<span class="br0">(</span><span

class="kw3">int</span> number<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">number</span> = number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getZoneNumber<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> zoneNumber<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setZoneNumber<span

class="br0">(</span><span class="kw3">int</span> zoneNumber<span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">zoneNumber</span> = zoneNumber<span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre>
      <h3 id="toc38"><a name="Model-Composite key-Embedded id"></a>Embedded id</h3>
      In this case you have a reference to a <em><a class="wiki_link_ext" href="http://java.sun.com/javaee/5/docs/api/javax/persistence/Embeddable.html"

          rel="nofollow">@Embeddable</a></em> object marked as <em><a class="wiki_link_ext"

          href="http://java.sun.com/javaee/5/docs/api/javax/persistence/EmbeddedId.html"

          rel="nofollow">@EmbeddedId</a></em>:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
<span class="kw2">public</span> <span class="kw2">class</span> Warehouse <span class="br0">{</span>
&nbsp;
 @EmbeddedId
 <span class="kw2">private</span> WarehouseKey key<span class="sy0">;</span>
&nbsp;
 @Column<span class="br0">(</span>length=<span class="nu0">40</span><span class="br0">)</span> @Required
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> name<span class="sy0">;</span>
&nbsp;
 <span class="kw2">public</span> WarehouseKey getKey<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> key<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setKey<span class="br0">(</span>WarehouseKey key<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">key</span> = key<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> getName<span class="br0">(</span><span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">return</span> name<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setName<span class="br0">(</span><a

href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span class="kw21">String</span></a> name<span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">name</span> = name<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span>
&nbsp;</pre>
      And you key is an embeddable class that holds the key properties:<br>
      <pre class="java5"><span class="kw2">package</span> <span class="co2">org.openxava.test.model</span><span

class="sy0">;</span>
&nbsp;
<span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
&nbsp;
<span class="co3">/**
 *
 * @author Javier Paniza
 */</span>
&nbsp;
@Embeddable
<span class="kw2">public</span> <span class="kw2">class</span> WarehouseKey <span

class="kw2">implements</span> java.<span class="me1">io</span>.<a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/io/Serializable.html"><span

class="kw20">Serializable</span></a> <span class="br0">{</span>
&nbsp;
&nbsp;
 @Column<span class="br0">(</span>length=<span class="nu0">3</span>, name=<span

class="st0">"ZONE"</span><span class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">int</span> zoneNumber<span class="sy0">;</span>
&nbsp;
 @Column<span class="br0">(</span>length=<span class="nu0">3</span><span class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">int</span> number<span class="sy0">;</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getNumber<span class="br0">(</span><span

class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setNumber<span class="br0">(</span><span

class="kw3">int</span> number<span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">number</span> = number<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">int</span> getZoneNumber<span

class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
 <span class="kw2">return</span> zoneNumber<span class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="kw2">public</span> <span class="kw3">void</span> setZoneNumber<span

class="br0">(</span><span class="kw3">int</span> zoneNumber<span class="br0">)</span> <span

class="br0">{</span>
 <span class="kw2">this</span>.<span class="me1">zoneNumber</span> = zoneNumber<span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre>
      <h2 id="toc39"><a name="Model-Bean Validation"></a>Bean Validation</h2>
      OpenXava has full support for the Java standard for <a class="wiki_link_ext"

        href="http://beanvalidation.org/" rel="nofollow">Bean Validation</a>
      (1.1 JSR-349 since v5.3 and 1.0 JSR-303 since v4.1). You can define your
      own constraints for your entities as explained in Bean Validation
      specification, and OpenXava will recognize them, showing the corresponding
      validation messages to the user. Consult the latest <a class="wiki_link_ext"

        href="https://docs.jboss.org/hibernate/validator/6.0/reference/en-US/html_single/"

        rel="nofollow">Hibernate Validator documentation</a> to learn how to
      write a JSR-349 validator, since the current version of Hibernate
      Validator implements JSR-349.<br>
      Moreover, since v5.3 the OpenXava annotations <em><a class="wiki_link_ext"

          href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Required.html"

          rel="nofollow">@Required</a></em>, <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValidator.html"

          rel="nofollow">@PropertyValidator</a></em> and <em><a class="wiki_link_ext"

          href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/EntityValidator.html"

          rel="nofollow">@EntityValidator</a></em> are defined as Bean
      Validation constraints, that means that when you save an entity using
      directly JPA these validations will apply.<br>
      On the other hand, <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/RemoveValidator.html"

          rel="nofollow">@RemoveValidator</a></em>, <em>@PropertyValidator(onlyOnCreate=true)</em>,
      <em>EntityValidator(onlyOnCreate=true)</em> and the <a class="wiki_link"

        href="#Model-Properties-Default%20validator%20%28new%20in%20v2.0.3%29">default
        validator</a> feature of OpenXava are not recognized by Bean Validation
      or JPA, but only by OpenXava.<br>
      <h3 id="toc40"><a name="Model-Bean Validation-@AssertTrue"></a>@AssertTrue</h3>
      Since v4.9 OpenXava allows to inject properties and qualified properties
      (reference properties) that belong to validated bean, into the message
      identified by means of the message element of <em><a class="wiki_link_ext"

          href="http://docs.oracle.com/javaee/6/api/javax/validation/constraints/AssertTrue.html"

          rel="nofollow">@AssertTrue</a></em>. Example:<br>
      In this case we have an <em>@AssertTrue</em> annotating a field of the
      entity:<br>
      <pre class="java5"><span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.model.*</span>
<span class="kw2">import</span> <span class="co2">javax.validation.constraints.*</span><span

class="sy0">;</span>
&nbsp;
@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
<span class="kw2">public</span> <span class="kw2">class</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/sql/Driver.html"><span

class="kw44">Driver</span></a> <span class="kw2">extends</span> Identifiable<span

class="br0">{</span>
&nbsp;
 @Required
 @Column<span class="br0">(</span>length=<span class="nu0">40</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> name<span class="sy0">;</span>
&nbsp;
 @AssertTrue<span class="br0">(</span>message=<span class="st0">"{disapproved_driving_test}"</span><span

class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">boolean</span> approvedDrivingTest<span

class="sy0">;</span>
&nbsp;
 @OneToMany<span class="br0">(</span>mappedBy=<span class="st0">"driver"</span><span

class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/Collection.html"><span

class="kw46">Collection</span></a><span class="sy0">&lt;</span>Vehicle<span class="sy0">&gt;</span> vehicles = <span

class="kw2">new</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/util/ArrayList.html"><span

class="kw46">ArrayList</span></a><span class="sy0">&lt;</span>Vehicle<span class="sy0">&gt;</span><span

class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
 <span class="co1">//getters and setters...</span>
<span class="br0">}</span></pre>
      <em>{disapproved_driving_test}</em> is the message identifier that is
      declared under i18n file like this:<br>
      <pre class="text">disapproved_driving_test=Driver {name} can not be registered: must approve the driving test</pre>
      If we try to create an entity with <em>name=MIGUEL GRAU</em> and <em>approvedDrivingTest=false</em>
      the next error message will be shown:<br>
      <br>
      <em>Driver MIGUEL GRAU can not be registered: must approved the driving
        test</em><br>
      <br>
      In this case we have an <em>@AssertTrue</em> annotating a method of the
      entity:<br>
      <pre class="java5"><span class="kw2">import</span> <span class="co2">javax.persistence.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.annotations.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">org.openxava.model.*</span><span

class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">javax.validation.constraints.*</span><span

class="sy0">;</span>
&nbsp;
@<a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Entity"><span

class="kw166">Entity</span></a>
<span class="kw2">public</span> <span class="kw2">class</span> Vehicle <span class="kw2">extends</span> Identifiable<span

class="br0">{</span>
&nbsp;
 @Required
 @Column<span class="br0">(</span>length=<span class="nu0">15</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> type<span class="sy0">;</span>
&nbsp;
 @Required
 @Column<span class="br0">(</span>length=<span class="nu0">7</span><span class="br0">)</span>
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/lang/String.html"><span

class="kw21">String</span></a> licensePlate<span class="sy0">;</span>
&nbsp;
 <span class="kw2">private</span> <span class="kw3">boolean</span> roadworthy<span

class="sy0">;</span>
&nbsp;
 @ManyToOne
 <span class="kw2">private</span> <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/sql/Driver.html"><span

class="kw44">Driver</span></a> driver<span class="sy0">;</span>
&nbsp;
 @AssertTrue<span class="br0">(</span>message=<span class="st0">"{not_roadworthy}"</span><span

class="br0">)</span>
 <span class="kw2">private</span> <span class="kw3">boolean</span> isRoadworthyToAssignTheDriver<span

class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
     <span class="kw2">return</span> driver == <span class="kw4">null</span> || roadworthy<span

class="sy0">;</span>
 <span class="br0">}</span>
&nbsp;
 <span class="co1">//getters and setters...</span>
<span class="br0">}</span></pre>
      <em>{not_roadworthy}</em> is the message identifier that is declared under
      i18n file like this:<br>
      <pre class="text">not_roadworthy={type} plate {licensePlate} is not roadworthy. It can not be assigned to the driver {driver.name}</pre>
      If we have an entity: <em>type=AUTO</em>, <em>licensePlate=A1-0001</em>
      and <em>roadworthy=false</em>, and try to assign <em>driver (name =
        MIGUEL GRAU)</em>, the validation method will fail and display the error
      message:<br>
      <br>
      <em>AUTO plate A1-0001 is not roadworthy. It can not be assigned to the
        driver MIGUEL GRAU</em><br>
      <br>
      <h2 id="toc41"><a name="Model-Hibernate Validator (new in v3.0.1)"></a>Hibernate
        Validator <em>(new in v3.0.1)</em></h2>
      OpenXava has full support for <a class="wiki_link_ext" href="http://validator.hibernate.org/"

        rel="nofollow">Hibernate Validator</a> with Bean Validation support.
      Hibernate Validator 3.x (with the old API) was supported until v5.2.x. You
      can define your own constraints for your entities as explained in <span class="wiki_link_ext">Hibernate
        Validator documentation</span>, and OpenXava will recognize them,
      showing the corresponding validation messages to the user.<br>
      Moreover, the OpenXava annotations <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/Required.html"

          rel="nofollow">@Required</a></em>, <em><a class="wiki_link_ext" href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/PropertyValidator.html"

          rel="nofollow">@PropertyValidator</a></em> and <em><a class="wiki_link_ext"

          href="http://www.openxava.org/OpenXavaDoc/apidocs/org/openxava/annotations/EntityValidator.html"

          rel="nofollow">@EntityValidator</a></em> are defined as Hibernate
      Validator 3.x constraints until v5.2.x and as Bean Validation constraints
      since v5.3. </div>
  </body>
</html>
